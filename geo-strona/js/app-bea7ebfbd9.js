"use strict";function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,a=new Array(t.length);e<t.length;e++)a[e]=t[e];return a}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,a){return e&&_defineProperties(t.prototype,e),a&&_defineProperties(t,a),t}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t,e){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?e():"function"==typeof define&&define.amd?define(e):e()}(0,function(){var e=function(){function i(t,e){for(var a in _classCallCheck(this,i),this.$search=t,this.options={url:null},e)e.hasOwnProperty(a)&&(this.options[a]=e[a]);if(this.options.searchUrlPrefix=t.attr("data-search-url-prefix")||null,null===this.options.url)throw"Required parameter missing.";this.build(),this.init();var n=this;this.$search.on("search:clear",function(){n.clearSearch()})}return _createClass(i,[{key:"build",value:function(){var t=$("<div>",{class:"search-input form-group"});t.append($("<input>",{type:"text",class:"form-control",placeholder:"Szukaj"})),t.append($("<div>",{class:"underline"})),t.append($("<div>",{class:"search-active-info"})),t.append($("<div>",{class:"search-icon"}).append($("<span>",{class:"icon icon-search3"})));var e=$("<div>",{class:"search-results"});e.append($("<div>",{class:"content"}).append($("<ul>",{}))),this.$search.append(t),this.$search.append(e)}},{key:"init",value:function(){var a,n=this,t=this.$search.find("input");i.fillInput(t),t.on("keyup",function(t){var e=t.keyCode;n.options.searchUrlPrefix&&13===e?n.handleEnter():(a&&clearTimeout(a),a=setTimeout(function(){n.runSearch()},500))}),this.$search.find(".search-icon").on("click",function(){n.handleEnter()}),t.on("focus",function(){n.$search.addClass("search-focus")}),t.on("focusout",function(){n.$search.removeClass("search-focus")})}},{key:"readInputValue",value:function(){return this.$search.find("input").val().replace(/\s+/g," ").trim()}},{key:"handleEnter",value:function(){var t=this.readInputValue();if(t.length<3)self.runSearch();else{var e=this.options.searchUrlPrefix;e.startsWith("/")||(e="/"+e),e.endsWith("/")||(e+="/"),window.location.href="".concat(e,"search=").concat(encodeURI(t))}}},{key:"runSearch",value:function(){var r=this,s=r.$search.find(".search-results .content"),t=this.readInputValue();if(t.length<3){s.find("> ul").html("");var e=$("<li>",{class:"item-too-short",html:"<span>Tekst wyszukiwania jest zbyt krótki...</span>"});s.find("> ul").append(e),s.slideDown(100)}else{r.$search.addClass("search-active");var l=new Set(t.split(" "));$.ajax({url:r.options.url,data:{search:t},cache:!1,type:"GET",dataType:"json",success:function(t){if(void 0===t.data){s.html("");var e=$("<div>",{class:"item-no-results",html:"<span>Brak wyników spełniających kryteria...</span>"});s.append(e),s.slideDown(100),setTimeout(function(){r.$search.removeClass("search-active")},100)}else{s.html("<ul></ul>");for(var a=0,n=t.data.length;a<n;++a){var i=null;if("function"==typeof r.options.createLi)i=r.options.createLi(t.data[a],l);else{i=$("<li>");var o=$("<span>",{html:t[a].name,"data-id":t[a].id});i.append(o)}s.find("> ul").append(i)}s.slideDown(100),setTimeout(function(){r.$search.removeClass("search-active")},100)}}})}r.$search.addClass("search-has-results")}},{key:"clearSearch",value:function(){var t=this.$search.find(".search-results .content"),e=this.$search.find("input");t.find("> ul").html(""),t.hide(),this.$search.removeClass("search-has-results"),e.val("")}}],[{key:"fillInput",value:function(t){var e=window.location.href.split("/").reverse(),a="search=",n=!0,i=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var l=r.value;if(l.startsWith(a)){t.val(decodeURI(l.substr(a.length)));break}}}catch(t){i=!0,o=t}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}}}]),i}(),p=function(){function v(){_classCallCheck(this,v)}return _createClass(v,null,[{key:"show",value:function(e,t){try{e=JSON.parse(e)}catch(t){return}if(0!==e.length){(t=parseInt(t)||1)>e.length||t<1?t=0:t--;var a=$("#main-content"),n=$("<div>",{class:"content"});n.append(v.renderSettings()),n.append(v.renderCarouselImages(e)),n.append(v.renderExpander()),n.append(v.renderCarouselThumbnails(e));var i=$("<div>",{class:"gallery-fullscreen"});i.append(n),$("body").append(i);var o=i.find(".trigger-zoom-in"),r=i.find(".trigger-zoom-out"),s=i.find("span.percent"),l=i.find(".carousel-images"),d=i.find(".carousel-thumbnails");l.slick({accessibility:!1,slidesToShow:1,slidesToScroll:1,infinite:!0,arrows:!0,fade:!1,swipe:!0,asNavFor:d,lazyLoad:"progressive",mobileFirst:!0,responsive:[{breakpoint:769,settings:{swipe:!1,fade:!0}}],prevArrow:'<button type="button" class="slick-prev"><span class="icon icon-arrow-left4"></span></button>',nextArrow:'<button type="button" class="slick-next"><span class="icon icon-arrow-right4"></span></button>',initialSlide:t,rows:0}),d.slick({accessibility:!1,slidesToShow:1,asNavFor:l,centerMode:!0,focusOnSelect:!0,infinite:!1,variableWidth:!0,arrows:!1,initialSlide:t,rows:0}),l.on("beforeChange",function(t,e,a,n){c=l.find(".item[data-index="+n+"] img")[0],u=c.naturalWidth+c.naturalHeight,f=c.clientWidth+c.clientHeight,p=parseInt(f/u*100),isNaN(p)?(s.html(""),r.addClass("disabled"),o.addClass("disabled")):(s.html(p+"%"),100===p?o.addClass("disabled"):o.removeClass("disabled")),d.slick("slickGoTo",n)}),l.find("*[draggable!=true]",".slick-track").unbind("dragstart"),l.on("afterChange",function(){l.find(".item.enlarged").each(function(){var t=$(this);t.removeClass("enlarged"),t.find("img").draggable("destroy").attr("style","")})}),i.addClass("shown");var c=l.find(".slick-current img")[0],u=c.naturalWidth+c.naturalHeight,f=c.clientWidth+c.clientHeight,p=parseInt(f/u*100);isNaN(p)?(s.html(""),r.addClass("disabled"),o.addClass("disabled")):(s.html("".concat(p,"%")),100===p?o.addClass("disabled"):o.removeClass("disabled"));var m=function(t){27===t.keyCode&&h(),38!==t.keyCode&&40!==t.keyCode||i.find(".expander").click(),37===t.keyCode&&l.slick("slickPrev"),39===t.keyCode&&l.slick("slickNext")},h=function(){document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen(),$(document).unbind("keyup",m),i.removeClass("shown"),a.removeClass("blurred"),setTimeout(function(){i.remove()},300)};$(document).keyup(m),i.click(function(t){if(!l.find(".slick-active").first().hasClass("enlarged")){var e=$(t.target);e.hasClass("icon")||e.hasClass("image")||e.hasClass("expander")||e.hasClass("settings")||e.hasClass("item-thumbnail")||e.hasClass("slick-arrow")||h()}}),i.find(".expander").click(function(){$(this).toggleClass("full-gallery-shown").removeClass("hover"),i.find(".carousel-images").toggleClass("full-gallery-shown"),i.find(".carousel-thumbnails").toggleClass("expanded")}),i.find(".trigger-enlarge").click(function(){var t=$(this);document.fullScreenElement&&null!==document.fullScreenElement||!document.mozFullScreen&&!document.webkitIsFullScreen?(document.documentElement.requestFullScreen?document.documentElement.requestFullScreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullScreen&&document.documentElement.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT),t.removeClass("icon-enlarge").addClass("icon-shrink")):(document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen(),t.removeClass("icon-shrink").addClass("icon-enlarge"))}),i.find(".trigger-close").click(function(){h()}),o.click(function(){o.hasClass("disabled")||(s.html("100%"),o.addClass("disabled"),r.removeClass("disabled"),l.find(".slick-active").each(function(){var t=$(this);t.addClass("enlarged"),t.find("img").draggable()}))}),r.click(function(){r.hasClass("disabled")||(r.addClass("disabled"),o.removeClass("disabled"),l.find(".slick-active").each(function(){var t=$(this);t.removeClass("enlarged");var e=t.find("img");e.draggable("destroy").attr("style","");var a=(e=e[0]).naturalWidth+e.naturalHeight,n=e.clientWidth+e.clientHeight,i=parseInt(n/a*100);s.html(i+"%")}))}),i.find(".trigger-download").click(function(){var t=l.slick("slickCurrentSlide");e[t]&&window.open(e[t],"_blank").focus()})}}},{key:"renderSettings",value:function(){var t=$("<div>",{class:"settings"});return t.append($("<span>",{class:"icon icon-cross2 trigger-close"})),t.append($("<span>",{class:"icon icon-enlarge trigger-enlarge"})),t.append($("<span>",{class:"icon icon-plus3 trigger-zoom-in"})),t.append($("<span>",{class:"percent"})),t.append($("<span>",{class:"icon icon-minus3 trigger-zoom-out disabled"})),t.append($("<span>",{class:"icon icon-download4 trigger-download"})),t}},{key:"renderCarouselImages",value:function(t){for(var e=$("<div>",{class:"carousel-images"}),a=0;a<t.length;a++){var n=$("<div>",{class:"item","data-index":a}),i=$("<img>",{src:t[a],class:"image"});n.append(i),e.append(n)}return e}},{key:"renderExpander",value:function(){return $("<button>",{class:"expander"}).append($("<span>",{class:"icon icon-arrow-up4"}))}},{key:"renderCarouselThumbnails",value:function(t){for(var e=$("<div>",{class:"carousel-thumbnails"}),a=0;a<t.length;a++){var n=$("<div>",{class:"item item-thumbnail","data-index":a}),i=$("<img>",{src:t[a],class:"image"});n.append(i),e.append(n)}return e}}]),v}(),a=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"pathAPI",value:function(t){var e=location.protocol+"//"+location.hostname+(location.port?":"+location.port:"");return t?e+"/api/v1/"+t:e+"/api/v1/"}}]),t}(),n=function(){function s(){_classCallCheck(this,s)}return _createClass(s,null,[{key:"getSpecialSigns",value:function(){return[".",",","!","/","<",">","?","\\",":","@","-"]}},{key:"manage",value:function(t,e){var a=e?t.find("input[name=withRegistrationPassword]"):t.find("input[name=password]"),n=t.find(".progress-bar"),o=t.find(".errors-list"),r=s.getClassesWithPatterns(!e);a.keyup(function(){var t=-1,e=$(this).val(),a=function(t){var e,a,n=0;for(var i in r)e=t,a=r[i],-1===e.search(a)?(o.find(i).show(),n++):o.find(i).hide();return 0<n?o.closest(".component-tip").show():o.closest(".component-tip").hide(),n}(e);switch(5<e.length&&(t=zxcvbn(e).score),(t-=a)<0&&(t=0),n.removeClass("progress-bar-danger").removeClass("progress-bar-warning").removeClass("progress-bar-info").removeClass("progress-bar-success"),t){case-1:return void n.css("width","0%");case 0:return n.css("width","20%"),void n.addClass("progress-bar-danger");case 1:return n.css("width","40%"),void n.addClass("progress-bar-warning");case 2:return n.css("width","60%"),void n.addClass("progress-bar-info");case 3:return n.css("width","80%"),void n.addClass("progress-bar-success");case 4:return n.css("width","100%"),void n.addClass("progress-bar-success")}})}},{key:"validatePassword",value:function(t,e){var a=$(t).val(),n=s.getClassesWithPatterns(e);for(var i in n)if(s.stringInvalid(a,n[i]))return!1;return!0}},{key:"stringInvalid",value:function(t,e){return-1===t.search(e)}},{key:"getClassesWithPatterns",value:function(t){var e={".min-length":new RegExp("^.{8,}$"),".capital-sign":new RegExp("[A-Z]"),".small-sign":new RegExp("[a-z]"),".digit":new RegExp("[0-9]")};return t&&(e[".special-sign"]=new RegExp("[".concat(s.getSpecialSigns().join(""),"]"))),e}}]),s}(),d=function(){function p(){_classCallCheck(this,p)}return _createClass(p,[{key:"index",value:function(t){this.$formManagement=t.find("form.form-management"),this.$formSubmit=t.find("form.form-submit"),this.init()}},{key:"init",value:function(){var i=this;n.manage(i.$formManagement,!0),i.$formManagement.find('input[type="text"], input[type="email"], input[type="password"], textarea, select').after('<span class="icon form-control-feedback"></span>'),i.$formManagement.validate({highlight:function(t){$(t).removeClass("is-valid").addClass("is-invalid"),$(t).parent().removeClass("is-valid").addClass("is-invalid"),$(t).parent().find(".form-control-feedback").removeClass("icon-checkmark").addClass("icon-cross")},unhighlight:function(t){$(t).removeClass("is-invalid").addClass("is-valid"),$(t).parent().removeClass("is-invalid").addClass("is-valid"),$(t).parent().find(".form-control-feedback").removeClass("icon-cross").addClass("icon-checkmark")},errorPlacement:function(t,e){$(e).removeClass("is-valid").addClass("is-invalid"),$(e).parent().find(".form-control-feedback").removeClass("icon-checkmark").addClass("icon-cross"),$(e).parent().find(".feedback-message").append(t)},ignore:".validation-ignore, :hidden",rules:{withRegistrationPassword:{password_custom:!0},withRegistrationPasswordRepeated:{equalTo:'input[name="withRegistrationPassword"]'},withRegistrationEmail:{remote:{url:"/register/validate/email",type:"get",data:{email:function(){return i.$formManagement.find('input[name="withRegistrationEmail"]').val()}}}},withRegistrationPhone:{remote:{url:"/register/validate/phone",type:"get",data:{phone:function(){return i.$formManagement.find('input[name="withRegistrationPhone"]').val()}}}}},messages:{withRegistrationEmail:{remote:"Podany login jest błędny lub został już przypisany do użytkownika."}}}),i.$formManagement.submit(function(t){t.preventDefault(),t.stopPropagation()}),i.$formManagement.find(".btn-submit").click(function(){i.submitForm()}),i.$formManagement.find(".products-management .count input").change(function(){var t=$(this).closest(".product"),e=Math.abs(parseInt($(this).val()))||1;i.changeCount(t,e)}),i.$formManagement.find(".products-management .click-increase").click(function(){var t=$(this).closest(".product"),e=t.find(".count input"),a=Math.abs(parseInt(e.val()))||0;a++,i.changeCount(t,a)}),i.$formManagement.find(".products-management .click-decrease").click(function(){var t=$(this).closest(".product"),e=t.find("input"),a=Math.abs(parseInt(e.val()))||2;--a<1&&(a=1),i.changeCount(t,a)}),i.$formManagement.find(".products-management .click-remove").click(function(){var t=$(this).closest(".product"),e=parseInt(t.attr("data-id")),a=parseInt(t.attr("data-bundle-id")),n=i.$formManagement.find('.products-overview .product[data-id="'.concat(e,'"]')).first();a&&i.$formManagement.find('.product[data-bundle-id="'.concat(a,'"]')).remove(),t.remove(),n.remove(),i.recalculate()}),i.$formManagement.find(".delivery-method").click(function(t){t.preventDefault(),t.stopPropagation();var e=$(this),a=parseInt(e.attr("data-id"));i.$formManagement.find(".delivery-method").removeClass("checked").removeClass("has-error"),e.addClass("checked"),e.find("input").prop("checked",!0),i.$formManagement.find(".payment-methods").removeClass("checked"),i.$formManagement.find('.payment-methods[data-delivery-id="'+a+'"]').addClass("checked")}),i.$formManagement.find(".payment-method").click(function(t){t.preventDefault(),t.stopPropagation();var e=$(this),a=e.attr("data-id");i.$formManagement.find(".payment-method").removeClass("checked").removeClass("has-error"),e.addClass("checked"),i.$formManagement.find('input[name="payment_method_id"]').val(a),e.find("input").prop("checked",!0)}),i.$formManagement.find(".go-to-stage-1").click(function(){i.$formManagement.find(".stage-1").find("> .card-body").slideDown(300),i.$formManagement.find(".stage-2").find("> .card-body").slideUp(300),i.$formManagement.find(".stage-3").find("> .card-body").slideUp(300),i.$formManagement.find(".stage-4").find("> .card-body").slideUp(300),setTimeout(function(){i.scrollToStage(1)},300)}),i.$formManagement.find(".go-to-stage-2").click(function(){1<=i.$formManagement.find(".products-management .product").length&&(i.$formManagement.find(".stage-1").find("> .card-body").slideUp(300),i.$formManagement.find(".stage-2").find("> .card-body").slideDown(300),i.$formManagement.find(".stage-3").find("> .card-body").slideUp(300),i.$formManagement.find(".stage-4").find("> .card-body").slideUp(300),setTimeout(function(){i.scrollToStage(2)},300))}),i.$formManagement.find(".go-to-stage-3").click(function(){var t=i.$formManagement.find(".delivery-and-payment"),e=parseInt(t.find(".delivery-method.checked input").val())||0,a=parseInt(t.find(".payment-methods.checked .payment-method.checked input").val())||0;return 0===e?(i.$formManagement.find(".delivery-method").addClass("has-error"),0):0===a?(i.$formManagement.find(".payment-method").addClass("has-error"),0):(i.$formManagement.find(".stage-1").find("> .card-body").slideUp(300),i.$formManagement.find(".stage-2").find("> .card-body").slideUp(300),i.$formManagement.find(".stage-3").find("> .card-body").slideDown(300),i.$formManagement.find(".stage-4").find("> .card-body").slideUp(300),void setTimeout(function(){i.scrollToStage(3)},300))}),i.$formManagement.find(".go-to-stage-3-registered").click(function(){i.$formManagement.find('input[name="order_type"]').val(1);var t=$(this).closest(".has-account"),e=t.find("input[name=email]").val(),a=t.find("input[name=password]").val(),n=t.closest(".shopping-cart").find("form.form-login");n.find("input[name=email]").val(e),n.find("input[name=password]").val(a),n.find("input[name=redirect]").val("/cart"),n.submit(),setTimeout(function(){i.scrollToStage(3)},300)}),i.$formManagement.find(".go-to-stage-3-with-registration").click(function(){i.$formManagement.find('input[name="order_type"]').val(2),$(".order-type").slideUp(300),$(".order-with-registration").slideDown(300),setTimeout(function(){i.scrollToStage(3)},300)}),i.$formManagement.find(".go-to-stage-3-without-registration").click(function(){i.$formManagement.find('input[name="order_type"]').val(3),$(".order-type").slideUp(300),$(".order-without-registration").slideDown(300),setTimeout(function(){i.scrollToStage(3)},300)}),i.$formManagement.find('select[name="withRegistrationCounterpartyType"]').change(function(){0===parseInt($(this).val())?i.$formManagement.find(".order-with-registration .company").stop().slideDown(200):i.$formManagement.find(".order-with-registration .company").stop().slideUp(200)}),i.$formManagement.find('select[name="withoutRegistrationCounterpartyType"]').change(function(){0===parseInt($(this).val())?i.$formManagement.find(".order-without-registration .company").stop().slideDown(200):i.$formManagement.find(".order-without-registration .company").stop().slideUp(200)}),i.$formManagement.find(".go-to-stage-3-order-type").click(function(){i.$formManagement.find(".order-type").slideDown(300),i.$formManagement.find(".order-registered").slideUp(300),i.$formManagement.find(".order-with-registration").slideUp(300),i.$formManagement.find(".order-without-registration").slideUp(300),setTimeout(function(){i.scrollToStage(3)},300)}),i.$formManagement.find('input[name="registeredOtherAddress"]').change(function(){$(this).is(":checked")?i.$formManagement.find(".order-registered .other-address").stop().slideDown(200):i.$formManagement.find(".order-registered .other-address").stop().slideUp(200)}),i.$formManagement.find('input[name="withoutRegistrationOtherAddress"]').change(function(){$(this).is(":checked")?i.$formManagement.find(".order-without-registration .other-address").stop().slideDown(200):i.$formManagement.find(".order-without-registration .other-address").stop().slideUp(200)}),i.$formManagement.find('input[name="withRegistrationOtherAddress"]').change(function(){$(this).is(":checked")?i.$formManagement.find(".order-with-registration .other-address").stop().slideDown(200):i.$formManagement.find(".order-with-registration .other-address").stop().slideUp(200)}),i.$formManagement.find(".go-to-stage-4-registered").click(function(){if(i.$formManagement.valid())i.$formManagement.find('input[name="orderType"]').val(1),i.goToFinalStage();else{var t=i.$formManagement.validate();console.log(t.errorList),i.scrollToError()}}),i.$formManagement.find(".go-to-stage-4-with-registration").click(function(){if(!$(this).closest(".order-with-registration").find("input[name=withRegistrationPassword]").closest(".form-group").hasClass("has-error"))if(i.$formManagement.valid())i.$formManagement.find('input[name="orderType"]').val(2),i.goToFinalStage();else{var t=i.$formManagement.validate();console.log(t.errorList),i.scrollToError()}}),i.$formManagement.find(".go-to-stage-4-without-registration").click(function(){if(i.$formManagement.valid())i.$formManagement.find('input[name="orderType"]').val(3),i.goToFinalStage();else{var t=i.$formManagement.validate();console.log(t.errorList),i.scrollToError()}}),i.recalculate()}},{key:"scrollToError",value:function(){var t=this.$formManagement.find("input.is-invalid:visible").first();if(!(t.length<1)){var e=$(window).scrollTop(),a=e+$(window).height(),n=t.offset().top;n+t.height()<=a&&e<=n||($("html, body").animate({scrollTop:t.offset().top-30},300),setTimeout(function(){t.focus()},300))}}},{key:"scrollToStage",value:function(t){var e=null;switch(t){case 1:e=this.$formManagement.find(".stage-1").first();break;case 2:e=this.$formManagement.find(".stage-2").first();break;case 3:e=this.$formManagement.find(".stage-3").first();break;case 4:e=this.$formManagement.find(".stage-4").first()}if(!(null===t||e.length<1)){var a=$(window).scrollTop(),n=a+$(window).height(),i=e.offset().top;i+e.height()<=n&&a<=i||$("html, body").animate({scrollTop:e.offset().top-15},300)}}},{key:"recalculate",value:function(){p.removeCookie();var u=0,d=0;this.$formManagement.find(".products-management .product").each(function(){var t=$(this),e=parseInt(t.attr("data-id")),a=parseInt(t.attr("data-bundle-id"))||null,n=parseInt(t.attr("data-bundle-selection-id"))||null,i=parseInt(t.find(".count input").val()),o=t.attr("data-price"),r=t.attr("data-current-price-without-tax"),s=t.attr("data-original-price");p.setItemCount(e,i,o,r,s,a,n);var l=accounting.unformat(t.find(".without-tax .float").html());u+=o*i,d+=l*i}),u=u.toFixed(2);var t=this.$formManagement.find(".products-management .foot");t.find(".with-tax .float").html(accounting.formatMoney(u,"")),t.find(".without-tax .float").html(accounting.formatMoney(d,""));var e=this.$formManagement.find(".products-overview .foot").first();e.find(".with-tax .float").html(accounting.formatMoney(u,"")),e.find(".without-tax .float").html(accounting.formatMoney(d,"")),p.updateFreeAboveButton(u),this.$formManagement.find(".delivery-and-payment .delivery-methods > .delivery-method").each(function(){var t=$(this),e=parseInt(t.attr("data-payment-type")),a=parseFloat(t.attr("data-constant-cost")),n=JSON.parse(t.attr("data-dependat-costs")),i=0;if(1===e&&(i=a),2===e){var o=!0,r=!1,s=void 0;try{for(var l,d=n[Symbol.iterator]();!(o=(l=d.next()).done);o=!0){var c=l.value;parseFloat(c.costFrom)<=u&&(i=parseFloat(c.cost))}}catch(t){r=!0,s=t}finally{try{o||null==d.return||d.return()}finally{if(r)throw s}}}t.find(".cost .float").html(accounting.formatMoney(i,""))}),$("body").trigger("cart:refresh")}},{key:"changeCount",value:function(t,e){var a=accounting.unformat(t.find(".price .with-tax .float").html()),n=accounting.unformat(t.find(".price .without-tax .float").html()),i=parseInt(t.attr("data-id"));t.find(".total .with-tax .float").html(accounting.formatMoney(a*e,"zł")),t.find(".total .without-tax .float").html(accounting.formatMoney(n*e,"zł")),t.find(".count input").val(e);var o=this.$formManagement.find('.products-overview .product[data-id="'.concat(i,'"][data-bundle-id="0"]')).first();o.find(".total .with-tax .float").html(accounting.formatMoney(a*e,"zł")),o.find(".total .without-tax .float").html(accounting.formatMoney(n*e,"zł")),o.find(".count .value").html(e),this.recalculate()}},{key:"shoppingCartToJSON",value:function(){var l=[];return this.$formManagement.find(".products-management .product").each(function(){var t=$(this),e=parseInt(t.attr("data-id")),a=parseInt(t.attr("data-bundle-id"))||null,n=parseInt(t.attr("data-bundle-selection-id"))||null,i=parseInt(t.find(".count input").val())||1,o=parseFloat(t.attr("data-price")),r=parseInt(t.attr("data-vat-rate-value"));if(0<e){var s={product_id:e,bundle_id:a,selection_id:n,count:i,price:o,vat_rate_value:r};l.push(s)}}),JSON.stringify(l)}},{key:"goToFinalStage",value:function(){var t=this,e=parseInt(t.$formManagement.find('input[name="order_type"]').val())||1,a=t.$formManagement.find(".delivery-and-payment"),n=parseInt(a.find(".delivery-method.checked input").val())||0,i=parseInt(a.find(".payment-methods.checked .payment-method.checked input").val())||0;if(0===e||0===n||0===i)throw"Bad method call";var o,r,s,l,d,c,u,f,p,m,h,v,g,y,b,w,k,C,S,_=0,x=null,M=null;1===e?M="registered":2===e?M="withRegistration":3===e&&(M="withoutRegistration"),o=t.$formManagement.find('select[name="'.concat(M,'CounterpartyType"]')).val(),r=t.$formManagement.find('input[name="'.concat(M,'Email"]')).val(),s=t.$formManagement.find('input[name="'.concat(M,'Name"]')).val(),l=t.$formManagement.find('input[name="'.concat(M,'Surname"]')).val(),d=t.$formManagement.find('input[name="'.concat(M,'Phone"]')).val(),c=t.$formManagement.find('input[name="'.concat(M,'CompanyName"]')).val(),u=t.$formManagement.find('input[name="'.concat(M,'CompanyNIP"]')).val(),p=t.$formManagement.find('input[name="'.concat(M,'Street"]')).val(),m=t.$formManagement.find('input[name="'.concat(M,'StreetNumber"]')).val(),h=t.$formManagement.find('input[name="'.concat(M,'PostCode"]')).val(),v=t.$formManagement.find('input[name="'.concat(M,'City"]')).val(),g=t.$formManagement.find('input[name="'.concat(M,'Country"]')).val(),S=t.$formManagement.find('input[name="'.concat(M,'Password"]')).val(),f=t.$formManagement.find('input[name="'.concat(M,'CeneoZaufaneOpinie"]')).is(":checked")?1:0,t.$formManagement.find('input[name="'.concat(M,'Invoice"]')).is(":checked")&&(_=1),x=t.$formManagement.find('input[name="'.concat(M,'OtherAddress"]')).is(":checked")?(y=t.$formManagement.find('input[name="'.concat(M,'DeliveryStreet"]')).val(),b=t.$formManagement.find('input[name="'.concat(M,'DeliveryStreetNumber"]')).val(),w=t.$formManagement.find('input[name="'.concat(M,'DeliveryPostCode"]')).val(),k=t.$formManagement.find('input[name="'.concat(M,'DeliveryCity"]')).val(),t.$formManagement.find('input[name="'.concat(M,'DeliveryCountry"]')).val()):(y=p,b=m,w=h,k=v,g),C=t.$formManagement.find('textarea[name="'.concat(M,'AdditionalInfo"]')).val();var I=t.$formManagement.find(".delivery-method.checked"),T=I.find(".title").html(),F=I.find(".description").html(),P=t.$formManagement.find(".payment-methods.checked .payment-method.checked"),D=P.find(".title").html(),z=P.find(".description").html(),A=t.$formManagement.find(".stage-4 .order-overview").first();A.find(".name").html(s),A.find(".surname").html(l),A.find(".street").html("".concat(p," ").concat(m)),A.find(".city").html("".concat(h," ").concat(v)),A.find(".email").html(r),A.find(".phone").html(d),A.find(".delivery-street").html("".concat(y," ").concat(b)),A.find(".delivery-city").html("".concat(w," ").concat(k)),A.find(".shipment-title").html(T),A.find(".shipment-description").html(F),A.find(".payment-title").html(D),A.find(".payment-description").html(z),A.find(".additional-info").html(C);var N,O,B=0,E=0;t.$formManagement.find(".products-management .product").each(function(){var t=$(this),e=parseFloat(t.attr("data-price")),a=accounting.unformat(t.find(".without-tax .float").html()),n=parseInt(t.find('input[name="count"]').val());B+=e*n,E+=a*n}),A.find(".total-with-tax").html(accounting.formatMoney(B,"")),A.find(".total-without-tax").html(accounting.formatMoney(E,"")),N=accounting.unformat(I.find(".cost").html()),O=accounting.unformat(P.find(".cost").html()),A.find(".delivery-cost").html(accounting.formatMoney(N+O,"")),A.find(".total-cost").html(accounting.formatMoney(B+N+O,"")),t.$formSubmit.find('input[name="order_type"]').val(e),t.$formSubmit.find('input[name="delivery_method_id"]').val(n),t.$formSubmit.find('input[name="payment_method_id"]').val(i),t.$formSubmit.find('input[name="delivery_cost"]').val(N),t.$formSubmit.find('input[name="payment_cost"]').val(O),t.$formSubmit.find('input[name="counterparty_type"]').val(o),t.$formSubmit.find('input[name="email"]').val(r),t.$formSubmit.find('input[name="name"]').val(s),t.$formSubmit.find('input[name="surname"]').val(l),t.$formSubmit.find('input[name="phone"]').val(d),t.$formSubmit.find('input[name="company_name"]').val(c),t.$formSubmit.find('input[name="company_nip"]').val(u),t.$formSubmit.find('input[name="street"]').val(p),t.$formSubmit.find('input[name="street_number"]').val(m),t.$formSubmit.find('input[name="post_code"]').val(h),t.$formSubmit.find('input[name="city"]').val(v),t.$formSubmit.find('input[name="country"]').val(g),t.$formSubmit.find('input[name="invoice"]').val(_),t.$formSubmit.find('input[name="delivery_street"]').val(y),t.$formSubmit.find('input[name="delivery_street_number"]').val(b),t.$formSubmit.find('input[name="delivery_post_code"]').val(w),t.$formSubmit.find('input[name="delivery_city"]').val(k),t.$formSubmit.find('input[name="delivery_country"]').val(x),t.$formSubmit.find('input[name="additional_info"]').val(C),t.$formSubmit.find('input[name="shopping_cart_json"]').val(t.shoppingCartToJSON()),t.$formSubmit.find('input[name="password"]').val(S),t.$formSubmit.find('input[name="ceneoZaufaneOpinie"]').val(f),t.$formManagement.find(".stage-1").find("> .card-body").slideUp(300),t.$formManagement.find(".stage-2").find("> .card-body").slideUp(300),t.$formManagement.find(".stage-3").find("> .card-body").slideUp(300),t.$formManagement.find(".stage-4").find("> .card-body").slideDown(300),setTimeout(function(){t.scrollToStage(4)},300)}},{key:"submitForm",value:function(){this.$formSubmit.submit()}}],[{key:"removeCookie",value:function(){Cookies.remove("cartDataJSON",{path:"/"})}},{key:"setItemCount",value:function(t,e,a,n,i,o,r){var s=5<arguments.length&&void 0!==o?o:null,l=6<arguments.length&&void 0!==r?r:null;if(void 0===t||void 0===e||void 0===a)throw"Not enough parameters.";t=parseInt(t),e=parseInt(e)||1,a=parseFloat(a),n=parseFloat(n),i=parseFloat(i);var d,c=p.getItems();for(var u in c)c[u].id===t&&c[u].selection_id===l&&(c[u].count=e,c[u].price=a,c[u].price_without_tax=n,c[u].original_price=i,c[u].bundle_id=s,c[u].selection_id=l,d=!0);if(!d){var f={id:t,count:e,price:a,price_without_tax:n,original_price:i,bundle_id:s,selection_id:l};c.push(f)}Cookies.set("cartDataJSON",JSON.stringify(c),{expires:28,path:"/"})}},{key:"removeItem",value:function(t,e){var a=1<arguments.length&&void 0!==e?e:null;t=+t;var n=p.getItems(),i=[];for(var o in n)n[o].bundle_id===a&&n[o].id===t||a&&n[o].bundle_id===a||i.push(n[o]);Cookies.set("cartDataJSON",JSON.stringify(i),{expires:28,path:"/"})}},{key:"getItemCount",value:function(t,e){var a=1<arguments.length&&void 0!==e?e:null,n=Cookies.get("cartDataJSON");if(void 0===n)return 0;var i=null;try{i=JSON.parse(n)}catch(t){i=[]}for(var o in i)if(i[o].id===t&&i[o].bundle_id===a)return i[o].count;return 0}},{key:"getItems",value:function(){var t=Cookies.get("cartDataJSON");if(void 0===t)return[];var e=[];try{e=JSON.parse(t)}catch(t){e=[]}return e}},{key:"updateFreeAboveButton",value:function(t){var e=$(".free-delivery-above.btn"),a=parseFloat(e.attr("data-free-above"))||null;if(a){var n=(a-t).toFixed(2);n<=0?(e.find(".delivery-free").removeClass("d-none"),e.find(".delivery-paid").addClass("d-none")):(e.find(".delivery-free").addClass("d-none"),e.find(".delivery-paid").removeClass("d-none"),e.find(".lack").html(accounting.formatMoney(n,"")))}}}]),p}(),i=function(){function s(){_classCallCheck(this,s)}return _createClass(s,null,[{key:"manage",value:function(n){var t=parseInt(n.find("#webpage").attr("data-divisions-auto-hide")),e=n.find("#header");e.find(".expand").click(function(){e.hasClass("expanded")?Cookies.set("headerExpanded",0,{expires:60,path:"/"}):Cookies.set("headerExpanded",1,{expires:60,path:"/"}),e.toggleClass("expanded")}),n.find(".webpage-division").each(function(){s.initializeDivision($(this),t)}),n.find(".module").each(function(){s.animateModule($(this))}),n.find(".module-slider").each(function(){s.moduleSlider($(this))}),n.find(".module-gallery").each(function(){s.moduleGallery($(this))}),n.find(".module-gallery-multilevel").each(function(){s.moduleGalleryMultilevel($(this))}),n.find(".module-text-groups").each(function(){s.moduleTextGroups($(this))}),n.find(".module-products-slider").each(function(){s.moduleProductsSlider($(this))}),n.find(".module-properties-list").each(function(){s.modulePropertiesList($(this))}),n.find(".module-properties-plans").each(function(){s.modulePropertiesPlans($(this))}),n.find(".module-properties-search").each(function(){s.modulePropertiesSearch($(this))}),n.find(".module-properties-slider").each(function(){s.modulePropertiesSlider($(this))}),n.find(".module-faces-gallery").each(function(){s.moduleFacesGallery($(this))}),n.find(".module-posts").each(function(){s.modulePosts($(this))}),n.find(".module-text-slider").each(function(){s.moduleTextSlider($(this))}),n.find(".module-product-gallery").each(function(){s.moduleProductGallery($(this))}),n.find(".products-search").each(function(){s.moduleProductsSearch($(this))}),n.find(".module-products-change-sorting").each(function(){s.moduleProductsChangeSorting($(this))}),n.find(".module-products-change-view").each(function(){s.moduleProductsChangeView($(this))}),n.find(".module-shopping-cart-overview").each(function(){s.moduleShoppingCartOverview($(this))}),n.find(".module-shop-categories").each(function(){s.moduleShopCategories($(this))}),n.find(".module-pagination").each(function(){s.modulePagination($(this))}),n.find(".module-filters").each(function(){s.moduleFilters($(this))}),n.find(".module-schedule").each(function(){s.moduleSchedule($(this))}),n.find(".module-menu").each(function(){s.moduleMenu($(this))}),n.on("click",".tile, .listable-content > .item",function(t){var e=$(t.currentTarget).attr("data-url")||null;e&&(window.location.href=e)}),n.find("#property .property-gallery img").click(function(t){t.preventDefault();var e=n.find(".property-gallery").attr("data-images"),a=$(t.currentTarget||t.target).attr("data-index");p.show(e,a)}),s.moduleSharers(n.find(".module-sharers")),s.moduleFavorites()}},{key:"initializeDivision",value:function(n,i){n.hasClass("division-collapsing")&&n.find("> div > h1, > div > h2, > div > h3").click(function(){var t=$(this).closest(".webpage-division"),e=t.find("> div > .content");if(t.hasClass("collapsed")){if(e.slideDown(300),i){var a=n.closest("#webpage").find(".division-collapsing").not(".collapsed");a.find("> div > .content").slideUp(300),a.addClass("collapsed")}}else e.slideUp(300);t.toggleClass("collapsed")})}},{key:"animateModule",value:function(t){var e=Boolean(parseInt(t.attr("data-animation"))),a=Boolean(parseInt(t.attr("data-slide"))),n=Boolean(parseInt(t.attr("data-fade")));if(e&&(a||n)){var i=[],o=[],r=[];if(a){var s=parseInt(t.attr("data-slide-duration-time")),l=parseInt(t.attr("data-slide-delay-time")),d="";switch(s+="ms",l+="ms",parseInt(t.attr("data-animation-transition-style"))){case 1:d="left";break;case 2:d="right";break;case 3:d="top";break;case 4:d="bottom";break;default:d=""}t.find("> .content").addClass("animation-slide").addClass(d),i.push(s),o.push(l),r.push(d)}if(n){var c=parseInt(t.attr("data-fade-duration-time")),u=parseInt(t.attr("data-fade-delay-time"));c+="ms",u+="ms",t.find("> .content").addClass("animation-fade"),i.push(c),o.push(u),r.push("opacity")}var f=t.find("> .content"),p=function t(){var e=$(window).scrollTop(),a=window.innerHeight,n=f.offset().top+f.height()/2<=e+a;return n&&(f.css({"transition-delay":o,"transition-duration":i,"transition-property":r}),f.addClass("animated"),$(window).unbind("scroll",t)),n};$(window).bind("scroll",p),p()}}},{key:"moduleSlider",value:function(n){var t=parseInt(n.attr("data-items-xs")),e=parseInt(n.attr("data-items-sm")),a=parseInt(n.attr("data-items-md")),i=parseInt(n.attr("data-items-lg")),o=parseInt(n.attr("data-items-xl"));n.find("> .items").slick({accessibility:!1,adaptiveHeight:Boolean(parseInt(n.attr("data-auto-height")))||!1,autoplay:Boolean(parseInt(n.attr("data-auto-play"))),autoplaySpeed:parseInt(n.attr("data-auto-play-speed")),slidesToShow:o,slidesToScroll:o,responsive:[{breakpoint:1840,settings:{slidesToShow:i,slidesToScroll:i}},{breakpoint:1200,settings:{slidesToShow:a,slidesToScroll:a}},{breakpoint:892,settings:{slidesToShow:e,slidesToScroll:e}},{breakpoint:576,settings:{slidesToShow:t,slidesToScroll:t}}],speed:n.attr("data-pagination-speed")||800,pauseOnHover:Boolean(parseInt(n.attr("data-stop-on-hover")))||!1,arrows:Boolean(parseInt(n.attr("data-navigation")))||!1,prevArrow:'<button type="button" class="slick-prev"><span class="icon icon-arrow-left4"></span></button>',nextArrow:'<button type="button" class="slick-next"><span class="icon icon-arrow-right4"></span></button>',dots:Boolean(parseInt(n.attr("data-pagination")))||!1,fade:"slide"!==n.attr("data-transition-style"),rows:0}).attr("data-transition",n.attr("data-transition-style")),parseInt(n.attr("data-full-screen"))&&n.on("click",".item, .item-image",function(t){t.preventDefault();var e=n.children(".items").attr("data-images"),a=$(this).attr("data-index");p.show(e,a)})}},{key:"moduleGallery",value:function(i){i.on("click",".image",function(t){t.preventDefault();var e=$(this),a=parseInt(e.attr("data-index"))+1,n=i.attr("data-images");p.show(n,a)})}},{key:"moduleGalleryMultilevel",value:function(t){var e=parseInt(t.attr("data-items-xs")),a=parseInt(t.attr("data-items-sm")),n=parseInt(t.attr("data-items-md")),i=parseInt(t.attr("data-items-lg")),o=parseInt(t.attr("data-items-xl"));t.find("> .items").slick({adaptiveHeight:Boolean(parseInt(t.attr("data-auto-height")))||!1,autoplay:Boolean(parseInt(t.attr("data-auto-play"))),autoplaySpeed:parseInt(t.attr("data-auto-play-speed")),slidesToShow:o,slidesToScroll:o,responsive:[{breakpoint:1840,settings:{slidesToShow:i,slidesToScroll:i}},{breakpoint:1200,settings:{slidesToShow:n,slidesToScroll:n}},{breakpoint:892,settings:{slidesToShow:a,slidesToScroll:a}},{breakpoint:576,settings:{slidesToShow:e,slidesToScroll:e}}],speed:t.attr("data-pagination-speed")||800,pauseOnHover:Boolean(parseInt(t.attr("data-stop-on-hover")))||!1,arrows:Boolean(parseInt(t.attr("data-navigation")))||!1,prevArrow:'<button type="button" class="slick-prev"><span class="icon icon-arrow-left4"></span></button>',nextArrow:'<button type="button" class="slick-next"><span class="icon icon-arrow-right4"></span></button>',dots:Boolean(parseInt(t.attr("data-pagination")))||!1,rows:0}),t.on("click",".item",function(t){t.preventDefault();var e=$(this).attr("data-images");p.show(e)})}},{key:"moduleTextGroups",value:function(a){var t=Boolean(parseInt(a.attr("data-auto-hide-groups")))||!1,n=parseInt(a.attr("data-speed"))||400;t?a.find(".group-header").click(function(){var t=$(this).parent();if(t.hasClass("active"))t.find(".group-content").stop().slideUp(n),t.removeClass("active");else{var e=a.find(".group.active");e.removeClass("active"),e.find(".group-content").stop().slideUp(n),t.find(".group-content").stop().slideDown(n),t.addClass("active")}}):a.find(".group-header").click(function(){var t=$(this).parent();t.hasClass("active")?(t.find(".group-content").stop().slideUp(n),t.removeClass("active")):(t.find(".group-content").stop().slideDown(n),t.addClass("active"))})}},{key:"moduleProductsSlider",value:function(t){var e=parseInt(t.attr("data-items-xs")),a=parseInt(t.attr("data-items-sm")),n=parseInt(t.attr("data-items-md")),i=parseInt(t.attr("data-items-lg")),o=parseInt(t.attr("data-items-xl"));t.find("> .content > .products-container").slick({accessibility:!1,adaptiveHeight:Boolean(parseInt(t.attr("data-auto-height")))||!1,autoplay:Boolean(parseInt(t.attr("data-auto-play"))),autoplaySpeed:parseInt(t.attr("data-auto-play-speed")),slidesToShow:o,slidesToScroll:o,responsive:[{breakpoint:1840,settings:{slidesToShow:i,slidesToScroll:i}},{breakpoint:1200,settings:{slidesToShow:n,slidesToScroll:n}},{breakpoint:892,settings:{slidesToShow:a,slidesToScroll:a}},{breakpoint:576,settings:{slidesToShow:e,slidesToScroll:e}}],speed:t.attr("data-pagination-speed")||800,pauseOnHover:Boolean(parseInt(t.attr("data-stop-on-hover")))||!1,arrows:Boolean(parseInt(t.attr("data-navigation")))||!1,prevArrow:'<button type="button" class="slick-prev"><span class="icon icon-arrow-left4"></span></button>',nextArrow:'<button type="button" class="slick-next"><span class="icon icon-arrow-right4"></span></button>',dots:Boolean(parseInt(t.attr("data-pagination")))||!1,rows:0})}},{key:"modulePropertiesList",value:function(b){function n(){b.find(".btn-page").removeClass("active")}var t,e,a,w=+b.attr("data-path-type"),r=window.debounce(function(){b.find(".properties-list").addClass("out");var t=b.find(".select-branch select"),e=b.find(".select-investment.d-block select"),a=+t.val(),n=new Set,i=+e.val();i?n.add(i):b.find(".btn-investment.active").each(function(t,e){n.add(+$(e).attr("data-id"))});var o=new Set;b.find(".btn-building.active").each(function(t,e){o.add(+$(e).attr("data-id"))});var r=+b.find(".slider-area-min").html(),s=+b.find(".slider-area-max").html(),l=+(b.find(".slider-price-min").html()||"").replace(" ",""),d=+(b.find(".slider-price-max").html()||"").replace(" ",""),c=new Set;b.find(".btn-room.active").each(function(t,e){c.add(+$(e).html())});var u=new Set;b.find(".btn-floor.active").each(function(t,e){u.add(+$(e).html())});var f=1;b.find(".btn-page.active").each(function(t,e){f=+$(e).html()});var p="list";b.find(".btn-view.active").each(function(t,e){p=$(e).attr("data-view")});var m=null;b.find(".sortable.sorted").each(function(t,e){var a=$(e);m=a.attr("data-sort"),a.hasClass("sorted-desc")&&(m="-"+m)});var h={branch_id:a,investment_id:_toConsumableArray(n).join(","),building_id:_toConsumableArray(o).join(","),area_min:r,area_max:s,price_min:l,price_max:d,rooms_count:_toConsumableArray(c).join(","),floor:_toConsumableArray(u).join(","),page:f,sort:m,view:p},v=[];for(var g in h)v.push({name:g,value:h[g]});var y=v.filter(function(t){return!!t.value}).map(function(t){return"".concat(t.name,"=").concat(t.value)}).join("/");$.ajax({url:"/webpages/modules/".concat(b.attr("data-id"),"/properties/").concat(y),success:function(t){b.find(".properties-list").replaceWith(t),b.find(".properties-list").addClass("out"),setTimeout(function(){b.find(".properties-list").removeClass("out")},5);var e="".concat(location.host).concat(location.pathname),a=e.match(/([0-9a-z_./-]*\/)(((.*)=(.*))*)/i),n=e;if(a&&a[2]&&(n=e.replace(a[2],"")),n=n.endsWith("/")?n.substring(0,n.length-1):n,n="".concat(location.protocol,"//").concat(n),1==w){var i="".concat(n,"/").concat(y);window.history.pushState(null,null,i)}else if(2==w){var o="".concat(n,"#").concat(y);window.history.pushState(null,null,o)}else{var r="".concat(n);window.history.pushState(null,null,r)}}})},10),i=window.debounce(function(){r()},400);s.modulePropertiesSearch(b),t=b.find(".select-branch select"),e=b.find(".select-investment"),a=b.find(".btn-investment"),t.change(function(){n(),r()}),e.find("select").change(function(t){n(),r()}),a.click(function(t){n(),r()}),b.find(".slider-area-range").on("slide",function(){n(),i()}),b.find(".slider-price-range").on("slide",function(){n(),i()}),b.find(".btn-building").click(function(t){n(),r()}),b.find(".btn-room").click(function(t){n(),r()}),b.find(".btn-floor").click(function(t){n(),r()}),b.on("click",".btn-page",function(t){var e=$(t.currentTarget);b.find(".btn-page").removeClass("active"),e.addClass("active"),r()}),b.on("click",".btn-view",function(t){var e=$(t.currentTarget);b.find(".btn-view").removeClass("active"),e.addClass("active"),r()}),b.on("click",".listable-header .attributes .sortable",function(t){var e=$(t.currentTarget||t.target),a=e.hasClass("sorted-asc");b.find(".listable-header .attributes .sortable").removeClass("sorted"),e.addClass("sorted"),e.removeClass("sorted-asc"),e.removeClass("sorted-desc"),e.addClass(a?"sorted-desc":"sorted-asc"),n(),r()}),b.on("click",".btn-clear",function(t){b.find(".btn-room").removeClass("active"),b.find(".btn-page").removeClass("active"),b.find(".btn-floor").removeClass("active");var e=b.find(".slider-area-range"),a=b.find(".slider-area-min"),n=b.find(".slider-area-max"),i=e.slider("option","min"),o=e.slider("option","max");e.slider({values:[i,o]}),a.html(i),n.html(o),r()}),window.onpopstate=function(){var t=b.find(".select-branch select"),e=document.location.href.match(/([0-9a-z_./-]*\/)(((.*)=(.*))*)/i);if(e&&e[2]){var a=e[2].split("/").map(function(t){return t.split("=")}).reduce(function(t,e,a){return t[e[0]]=e[1],t},{});a.branch_id&&t.val(a.branch_id).trigger("change")}}}},{key:"modulePropertiesPlans",value:function(v){var t=v.find("img");t.on("load",function(t){var e=$(t.target).closest(".wrapper"),a=e.find("svg"),n=t.target.naturalWidth,i=t.target.naturalHeight;a.attr("viewBox","0 0 ".concat(n," ").concat(i)),e.addClass("initialized")}),t.each(function(t,e){var a=$(e);a.attr("src",a.attr("data-src"))}),v.find("polygon, .btn-plan").click(function(t){var e=$(t.currentTarget||t.target),a=e.attr("data-building-id"),n=e.attr("data-property-id"),i=e.attr("data-floor");if(n)window.location.href=e.attr("data-url")+"#3d";else{var o={building_id:a,floor:i},r=[];for(var s in o)r.push({name:s,value:o[s]});var l=r.filter(function(t){return!!t.value}).map(function(t){return"".concat(t.name,"=").concat(t.value)}).join("/"),d="".concat(location.host).concat(location.pathname),c=d.match(/([0-9a-z_./-]*\/)(((.*)=(.*))*)/i),u=d;c&&c[2]&&(u=d.replace(c[2],"")),u=u.endsWith("/")?u.substring(0,u.length-1):u,u="".concat(location.protocol,"//").concat(u);var f="".concat(u,"/").concat(l);f!=="".concat(location.protocol,"//").concat(d)&&window.history.pushState(null,null,f);var p=['[data-building-id="'.concat(a,'"]'),'[data-floor="'.concat(i,'"]')];""===a&&""===i?v.find(".navigation").addClass("d-none"):v.find(".navigation").removeClass("d-none"),v.find(".plan.active").removeClass("active");var m=v.find(".plan").filter(p.join("")).first();m.addClass("active");var h=[];m.find('polygon[data-property-id!=""]').each(function(t,e){h.push(+$(e).attr("data-property-id"))}),h.length&&(m.find(".wrapper").removeClass("initialized"),$.ajax({url:"/properties",data:{id:h.join(",")},success:function(t){var d=v.find(".plans");t.forEach(function(t){if(!d.find('.plan[data-property-id="'.concat(t.id,'"]')).first().length){var e="";t.gallery_floor_plan.length&&(e=t.gallery_floor_plan[0].large);var a="";a+='data-investment-id="'.concat(t.investment_id,'"'),a+='data-building-id="'.concat(t.building_id,'"'),a+='data-property-id="'.concat(t.id,'" data-floor=""');var n="";n+='<div class="plan plan-property" '.concat(a,">"),n+='\t<div class="wrapper initialized">',n+='\t\t<img class="image" src="'.concat(e,'" alt=""/>'),n+="\t</div>",n+="</div>",d.append(n);var i=function(t){return t.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-")},o="";o+="/katalog-mieszkan/",o+=i(t.investment.name),o+="/",o+=i(t.type.name),o+="/",o+=i(t.number),o+="-",o+=t.id;var r="";r+="".concat(t.type.name," "),r+='<span class="number">'.concat(t.number,"</span>"),t.area_usable&&(r+='<div class="area-usable">'.concat(t.area_usable," m²</div>"));var s=t.area-t.area_usable;0<s&&(s=accounting.formatNumber(s,2," "),r+='<div class="area-not-usable">+'.concat(s," m²</div>"));var l="Wolne";switch(t.status_id){case 4:l="Rezerwacja";break;case 5:case 6:l="Sprzedane"}r+='<div class="status">'.concat(l,"</div>"),d.find('polygon[data-property-id="'.concat(t.id,'"]')).attr("data-title",r).attr("data-status-id",t.status_id).attr("data-url",o)}}),m.find(".wrapper").addClass("initialized")}}))}});function e(){var t="".concat(location.host).concat(location.pathname).match(/([0-9a-z_./-]*\/)(((.*)=(.*))*)/i);if(t&&t[2]){var e=t[2].split("/").map(function(t){var e=t.split("=");return{name:e[0],value:+e[1]}}),a=e.find(function(t){return"building_id"===t.name}),n=e.find(function(t){return"floor"===t.name}),i=a?a.value:null,o=n?n.value:null,r=['[data-building-id="'.concat(null!==i?i:"",'"]'),'[data-floor="'.concat(null!==o?o:"",'"]')];if(null!==i||null!==o){var s=v.find("polygon").filter(r.join("")).first();s.length?s.click():(v.find(".plan.active").removeClass("active"),v.find(".plan:first-child").addClass("active"))}}else v.find(".plan.active").removeClass("active"),v.find(".plan:first-child").addClass("active"),v.find(".navigation").addClass("d-none")}e(),window.onpopstate=function(){e()};var a=v.find(".polygon-tooltip");v.on("mouseenter","polygon",function(){var t=$(this).attr("data-title");a.html(t)}),v.on("mousemove","polygon",function(t){a.css({top:t.clientY+15,left:t.clientX+15}),a.addClass("show")}),v.on("mouseleave","polygon",function(){a.removeClass("show")}),v.find(".btn-back").click(function(){window.history.back()})}},{key:"modulePropertiesSearch",value:function(j){function o(t){var e=0<arguments.length&&void 0!==t&&t,a=new Set,n=new Set,i=new Set,o=+j.find(".select-branch select").val();o&&a.add(o);var r=+j.find(".select-investment.d-block select").val();r&&n.add(r),j.find(".btn-investment.active").each(function(t,e){n.add(+$(e).attr("data-id"))}),j.find(".btn-building.active").each(function(t,e){i.add(+$(e).attr("data-id"))});var s=[],l=[],d=[],c=JSON.parse(j.find(".container-filters").attr("data-filters"));c.branches=c.branches.filter(function(t){return 0===a.size||a.has(t.id)}),s.push.apply(s,_toConsumableArray(c.branches)),c.branches.forEach(function(t){t.investments=t.investments.filter(function(t){return n.has(t.id)}),l.push.apply(l,_toConsumableArray(t.investments)),t.investments.forEach(function(t){t.buildings=t.buildings.filter(function(t){return i.has(t.id)}),d.push.apply(d,_toConsumableArray(t.buildings))})});var u=[];function f(t,a){return t.reduce(function(t,e){return e[a]<t?e[a]:t},t[0][a])}function p(t,a){return t.reduce(function(t,e){return e[a]>t?e[a]:t},t[0][a])}u=d.length?d:l.length?l:s;var m=Math.floor(f(u,"area_usable_min")),h=Math.ceil(p(u,"area_usable_max")),v=f(u,"floor_min"),g=p(u,"floor_max"),y=Math.floor(f(u,"price_min")),b=Math.ceil(p(u,"price_max")),w=f(u,"rooms_count_min"),k=p(u,"rooms_count_max"),C=j.find(".slider-area-range"),S=j.find(".slider-area-min"),_=j.find(".slider-area-max"),x=m,M=h;if(e){var I=C.slider("option","values")[0]||0,T=C.slider("option","values")[1]||100;x=m<I&&I<h?I:m,M=m<T&&T<h?T:h}C.slider("option","min",m),C.slider("option","max",h),C.slider({values:[x,M]}),S.html(x),_.html(M);var F=j.find(".slider-price-range"),P=j.find(".slider-price-min"),D=j.find(".slider-price-max"),z=y,A=b;if(e){var N=F.slider("option","values")[0]||0,O=F.slider("option","values")[1]||100;z=y<N&&N<b?N:y,A=m<O&&O<b?O:b}F.slider("option","min",y),F.slider("option","max",b),F.slider({values:[z,A]}),P.html(accounting.formatNumber(z,0," ")),D.html(accounting.formatNumber(A,0," ")),j.find(".btn-room").addClass("d-none");for(var B=w;B<=k;B++)j.find('.btn-room[data-value="'.concat(B,'"]')).removeClass("d-none");j.find(".btn-floor").addClass("d-none");for(var E=v;E<=g;E++)j.find('.btn-floor[data-value="'.concat(E,'"]')).removeClass("d-none")}var t,i,r,e,a,n,s,l,d,c,u,f,p,m;!function(){var a=j.find(".select-branch select"),n=j.find(".select-investment"),i=j.find(".btn-investment");a.change(function(){var t=+a.val(),e=j.find('.select-investment[data-branch-id="'.concat(t,'"]')).first();n.removeClass("d-block").addClass("d-none"),t?(e.removeClass("d-none").addClass("d-block"),e.find("select").trigger("change"),j.find(".col-investments").removeClass("d-none")):j.find(".col-investments").addClass("d-none"),o()}),n.find("select").change(function(t){var e=$(t.currentTarget).val();j.find(".select-building").addClass("d-none"),j.find('.select-building[data-investment-id="'.concat(e,'"]')).removeClass("d-none"),j.find(".btn-building").removeClass("active"),o()}),i.click(function(t){$(t.currentTarget).toggleClass("active"),j.find(".select-building").addClass("d-none"),j.find(".btn-building").removeClass("active");var e=i.filter(".active");if(1===e.length){var a=e.attr("data-id");j.find('.select-building[data-investment-id="'.concat(a,'"]')).removeClass("d-none")}o()});var t=a.val();j.find('.select-investment[data-branch-id="'.concat(t,'"]')).removeClass("d-none").addClass("d-block")}(),t=j.find(".slider-area-range"),i=j.find(".slider-area-min"),r=j.find(".slider-area-max"),e=Math.floor(+t.attr("data-min")),a=Math.floor(+t.attr("data-min-current"))||e,n=Math.ceil(+t.attr("data-max")),s=Math.ceil(+t.attr("data-max-current"))||n,t.slider({range:!0,min:e,max:n,values:[a,s],slide:function(t,e){var a=e.values[0],n=e.values[1];i.html(a),r.html(n)}}),i.html(a),r.html(s),l=j.find(".slider-price-range"),d=j.find(".slider-price-min"),c=j.find(".slider-price-max"),u=Math.floor(+l.attr("data-min")),f=Math.floor(+l.attr("data-min-current"))||u,p=Math.ceil(+l.attr("data-max")),m=Math.ceil(+l.attr("data-max-current"))||p,l.slider({range:!0,min:u,max:p,values:[f,m],slide:function(t,e){var a=e.values[0],n=e.values[1];d.html(accounting.formatNumber(a,0," ")),c.html(accounting.formatNumber(n,0," "))}}),d.html(accounting.formatNumber(u,0," ")),c.html(accounting.formatNumber(p,0," ")),j.find(".btn-building").click(function(t){$(t.currentTarget).toggleClass("active"),o()}),j.find(".btn-room").click(function(t){$(t.currentTarget).toggleClass("active")}),j.find(".btn-floor").click(function(t){$(t.currentTarget).toggleClass("active")}),o(!0),j.find(".btn-search").click(function(t){var e=j.find(".select-branch select"),a=j.find(".select-investment.d-block select"),n=[],i=j.attr("data-search-url"),o=+e.val();o&&n.push("branch_id="+o);var r=+a.val();if(r)n.push("investment_id="+r);else{var s=new Set;j.find(".btn-investment.active").each(function(t,e){s.add(+$(e).attr("data-id"))}),s.size&&n.push("investment_id="+_toConsumableArray(s).join(","))}var l=new Set;j.find(".btn-building.active").each(function(t,e){l.add(+$(e).attr("data-id"))}),l.size&&n.push("building_id="+_toConsumableArray(l).join(","));var d=+j.find(".slider-area-min").html();d&&n.push("area_min="+d);var c=+j.find(".slider-area-max").html();c&&n.push("area_max="+c);var u=new Set;j.find(".btn-room.active").each(function(t,e){u.add(+$(e).html())}),u.size&&n.push("rooms_count="+_toConsumableArray(u).join(","));var f=new Set;j.find(".btn-floor.active").each(function(t,e){f.add(+$(e).html())}),f.size&&n.push("floor="+_toConsumableArray(f).join(",")),n.length&&(i+="/".concat(n.join("/"))),window.location.href=i})}},{key:"modulePropertiesSlider",value:function(t){var e=parseInt(t.attr("data-items-xs")),a=parseInt(t.attr("data-items-sm")),n=parseInt(t.attr("data-items-md")),i=parseInt(t.attr("data-items-lg")),o=parseInt(t.attr("data-items-xl"));t.find("> .content > .tiles-properties").slick({accessibility:!1,adaptiveHeight:Boolean(parseInt(t.attr("data-auto-height")))||!1,autoplay:Boolean(parseInt(t.attr("data-auto-play"))),autoplaySpeed:parseInt(t.attr("data-auto-play-speed")),slidesToShow:o,slidesToScroll:1,responsive:[{breakpoint:1840,settings:{slidesToShow:i,slidesToScroll:i}},{breakpoint:1200,settings:{slidesToShow:n,slidesToScroll:n}},{breakpoint:892,settings:{slidesToShow:a,slidesToScroll:a}},{breakpoint:576,settings:{slidesToShow:e,slidesToScroll:e}}],speed:t.attr("data-pagination-speed")||800,pauseOnHover:Boolean(parseInt(t.attr("data-stop-on-hover")))||!1,arrows:Boolean(parseInt(t.attr("data-navigation")))||!1,prevArrow:'<button type="button" class="slick-prev"><span class="icon icon-arrow-left4"></span></button>',nextArrow:'<button type="button" class="slick-next"><span class="icon icon-arrow-right4"></span></button>',dots:Boolean(parseInt(t.attr("data-pagination")))||!1,rows:0})}},{key:"moduleFacesGallery",value:function(a){a.hasClass("slider")&&s.moduleFacesGallerySlider(a);var n=Boolean(parseInt(a.attr("data-information-name"))),i=Boolean(parseInt(a.attr("data-information-surname"))),o=Boolean(parseInt(a.attr("data-information-position"))),r=Boolean(parseInt(a.attr("data-information-description")));(n||i||o||r)&&a.find(".item").each(function(){var t=$(this),e="";(n||i)&&(e+="<h4>",n&&(e+=t.attr("data-name")+" "),i&&(e+=t.attr("data-surname")),e+="</h4>"),o&&(e+="<h5>"+t.attr("data-position")+"</h5>"),r&&(e+="<span>"+t.attr("data-description")+"</span>"),0<e.length&&t.tooltip({html:!0,title:e.replace(/(?:\r\n|\r|\n)/g,"<br>"),placement:"bottom",container:a})})}},{key:"moduleFacesGallerySlider",value:function(t){var e=parseInt(t.attr("data-items-xs")),a=parseInt(t.attr("data-items-sm")),n=parseInt(t.attr("data-items-md")),i=parseInt(t.attr("data-items-lg")),o=parseInt(t.attr("data-items-xl"));t.find("> .items").slick({accessibility:!1,adaptiveHeight:!1,autoplay:Boolean(parseInt(t.attr("data-auto-play"))),autoplaySpeed:parseInt(t.attr("data-auto-play-speed")),slidesToShow:o,slidesToScroll:o,responsive:[{breakpoint:1840,settings:{slidesToShow:i,slidesToScroll:i}},{breakpoint:1200,settings:{slidesToShow:n,slidesToScroll:n}},{breakpoint:892,settings:{slidesToShow:a,slidesToScroll:a}},{breakpoint:576,settings:{slidesToShow:e,slidesToScroll:e}}],speed:t.attr("data-pagination-speed")||800,pauseOnHover:Boolean(parseInt(t.attr("data-stop-on-hover")))||!1,arrows:Boolean(parseInt(t.attr("data-navigation")))||!1,prevArrow:'<button type="button" class="slick-prev"><span class="icon icon-arrow-left4"></span></button>',nextArrow:'<button type="button" class="slick-next"><span class="icon icon-arrow-right4"></span></button>',dots:Boolean(parseInt(t.attr("data-pagination")))||!1,rows:0})}},{key:"modulePosts",value:function(t){t.find(".post-content").each(function(){$(this).hasClass("extendable")&&$(this).find("> .html").height()<=240&&$(this).find("+ .extend").hide()}),t.find("> .post .extend span").each(function(){var t=$(this),e=t.closest(".post").find(".post-content"),a=e.outerHeight();t.click(function(){if(e.hasClass("extended"))e.removeClass("extended"),e.animate({"max-height":a},400),$("html, body").animate({scrollTop:e.offset().top-160},400);else{var t=e.find("> .html").height()+30;e.addClass("extended"),e.animate({"max-height":t},400)}})})}},{key:"moduleTextSlider",value:function(i){var t=parseInt(i.attr("data-items-xs")),e=parseInt(i.attr("data-items-sm")),a=parseInt(i.attr("data-items-md")),n=parseInt(i.attr("data-items-lg")),o=parseInt(i.attr("data-items-xl")),r=parseInt(i.attr("data-items-to-scroll"))||null,s=parseInt(i.attr("data-full-screen"))||null,l=i.attr("data-transition-style"),d=i.attr("data-transition-style-xs");window.innerWidth<768&&""!==d&&(l=d),i.find("> .items").slick({accessibility:!1,autoplay:Boolean(parseInt(i.attr("data-auto-play"))),autoplaySpeed:parseInt(i.attr("data-auto-play-speed")),slidesToShow:o,slidesToScroll:r||o,responsive:[{breakpoint:1840,settings:{slidesToShow:n,slidesToScroll:r||n}},{breakpoint:1200,settings:{slidesToShow:a,slidesToScroll:r||a}},{breakpoint:892,settings:{slidesToShow:e,slidesToScroll:r||e}},{breakpoint:576,settings:{slidesToShow:t,slidesToScroll:r||t}}],speed:i.attr("data-pagination-speed")||800,pauseOnHover:Boolean(parseInt(i.attr("data-stop-on-hover")))||!1,arrows:Boolean(parseInt(i.attr("data-navigation")))||!1,prevArrow:'<button type="button" class="slick-prev"><span class="icon icon-arrow-left4"></span></button>',nextArrow:'<button type="button" class="slick-next"><span class="icon icon-arrow-right4"></span></button>',dots:Boolean(parseInt(i.attr("data-pagination")))||!1,fade:"slide"!==l,rows:0}),s&&i.on("click",".slide",function(t){t.preventDefault();var e=$(this),a=parseInt(e.attr("data-index"))+1,n=i.find("> .items").attr("data-images");p.show(n,a)})}},{key:"moduleSharers",value:function(t){var e,a,n,i;t.each(function(){var t=$(this),e=t.attr("data-url"),a=t.attr("data-title");t.find(".btn-share-facebook").click(function(){window.open("https://www.facebook.com/sharer/sharer.php?u="+encodeURI(e)+"&t="+a,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=300,width=600")}),t.find(".btn-share-twitter").click(function(){window.open("https://twitter.com/intent/tweet?text="+a+"&url="+encodeURI(e),"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=300,width=600")})}),s.facebookInitialized||0<t.length&&(e=document,a="facebook-jssdk",i=e.getElementsByTagName("script")[0],e.getElementById(a)||((n=e.createElement("script")).id=a,n.src="//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.7",i.parentNode.insertBefore(n,i)),s.facebookInitialized=!0)}},{key:"moduleProductGallery",value:function(t){var e=t.children(".images"),n=e.children(".items"),a=e.attr("data-icon-next"),i=e.attr("data-icon-previous"),o=t.children(".thumbnails"),r=o.children(".items"),s=r.find("> *").length,l=+o.attr("data-items-xs")||3,d=+o.attr("data-items-sm")||3,c=+o.attr("data-items-md")||3,u=+o.attr("data-items-lg")||3,f=+o.attr("data-items-xl")||3;n.slick({accessibility:!0,autoplay:!1,slidesToShow:1,slidesToScroll:1,speed:800,dots:!1,fade:!1,asNavFor:r,infinite:!0,arrows:!0,prevArrow:'<button type="button" class="slick-prev"><span class="icon icon-'.concat(i,'"></span></button>'),nextArrow:'<button type="button" class="slick-next"><span class="icon icon-'.concat(a,'"></span></button>'),rows:0}),r.slick({accessibility:!1,asNavFor:n,focusOnSelect:!0,centerMode:3<s,centerPadding:0,infinite:3<s,arrows:!1,prevArrow:'<button type="button" class="slick-prev"><span class="icon icon-'.concat(i,'"></span></button>'),nextArrow:'<button type="button" class="slick-next"><span class="icon icon-'.concat(a,'"></span></button>'),rows:0,slidesToShow:f,slidesToScroll:f,responsive:[{breakpoint:1840,settings:{slidesToShow:u,slidesToScroll:u}},{breakpoint:1200,settings:{slidesToShow:c,slidesToScroll:c}},{breakpoint:892,settings:{slidesToShow:d,slidesToScroll:d}},{breakpoint:576,settings:{slidesToShow:l,slidesToScroll:l}}]}),n.find("a").click(function(t){t.preventDefault();var e=parseInt($(this).attr("data-index")),a=n.attr("data-urls");p.show(a,e)}),r.find("a").click(function(t){t.preventDefault()})}},{key:"moduleProductsSearch",value:function(t){new e(t,{url:a.pathAPI("products"),createLi:function(d,t){var c=d.name,u=d.producer_code;t.forEach(function(t){if("string"==typeof d.name){var e=d.name.toLowerCase().indexOf(t.toLowerCase());if(0<=e){var a=d.name.slice(0,e),n=d.name.slice(e,e+t.length),i=d.name.slice(e+t.length);c="".concat(a,"<u>").concat(n,"</u>").concat(i)}if(u){var o=d.producer_code.toLowerCase().indexOf(t.toLowerCase());if(0<=o){var r=d.producer_code.slice(0,o),s=d.producer_code.slice(o,o+t.length),l=d.producer_code.slice(o+t.length);u="".concat(r,"<u>").concat(s,"</u>").concat(l)}}}});var e=c;u&&(e=u+" - "+e);var a=$("<li>"),n=$("<a>",{html:e,href:d.url});return a.append(n),a}})}},{key:"moduleProductsChangeSorting",value:function(a){a.find("select").change(function(){var t=$(this).val(),e=a.attr("data-url");e=e.replace("#sort#",t),window.location=e})}},{key:"moduleProductsChangeView",value:function(t){t.find(".trigger-grid-view").click(function(){$("body").find(".products-container").each(function(){var t=$(this);0===t.closest(".module-products-slider").length&&t.removeClass("display-list").addClass("display-grid")}),Cookies.set("productsList","display-grid",{expires:60,path:"/"})}),t.find(".trigger-list-view").click(function(){$("body").find(".products-container").each(function(){var t=$(this);0===t.closest(".module-products-slider").length&&t.removeClass("display-grid").addClass("display-list")}),Cookies.set("productsList","display-list",{expires:60,path:"/"})})}},{key:"moduleShoppingCartOverview",value:function(n){function t(){var t=d.getItems(),e=0,a=0;new Set(t).forEach(function(t){e+=t.count,a+=t.count*t.price}),n.find(".items span").html(e),n.find(".price .float").html(accounting.formatNumber(a,2," ")+" zł")}t(),$("body").on("cart:refresh",function(){t()})}},{key:"moduleShopCategories",value:function(t){t.on("click","li > .icon.closed:not(.loaded)",function(t){t.stopPropagation();var e=$(this),a=e.parent(),n=a.attr("data-category-id"),i=function(t){return t.match(/[a-zA-Z0-9_-]+=[a-zA-Z0-9_,\s%-]+/gi)}(a.children("a").attr("href"))||[],o=i.join("/"),r={parent_id:n,is_active:!0,has_products:!0};i.forEach(function(t){var e=t.split("=");r[e[0]]=decodeURI(e[1])}),$.get({url:"/api/v1/products/categories",dataType:"json",data:r,success:function(t){!function(t,e,a,l){var d=$("<ul>",{});$.each(a,function(t,e){var a=$("<li>",{"data-category-id":e.id}),n=e.url;n.endsWith("/")||(n+="/");var i=$("<a>",{href:n+l}),o=$("<span>",{class:"icon icon-arrow-right2"}),r=" "+e.name;if(i.append(o),i.append(r),a.append(i),e.children_count){var s=$("<span>",{class:"icon icon-plus2 closed"});a.append(s)}d.append(a)}),t.append(d),e.addClass("loaded").trigger("click")}(a,e,t.data,o)}})})}},{key:"modulePagination",value:function(t){t.find("input").change(function(){var t=$(this),e=t.attr("data-url"),a=parseInt(t.attr("data-pages-count")),n=parseInt(t.val())||1;n<1&&(n=1),a<n&&(n=a),e=e.replace("#page#",""+n),window.location=e})}},{key:"moduleFilters",value:function(t){t.find('input[type="checkbox"]').change(function(){var t=$(this).closest(".list"),e=[];t.find('input[type="checkbox"]:checked').each(function(){e.push(parseInt($(this).val()))});var a=null;a=0<e.length?t.attr("data-url").replace("#ids#",e.join(",")):t.attr("data-url-clear"),window.location=a})}},{key:"moduleSchedule",value:function(d){var n=d.attr("data-url"),t="agendaWeek";window.innerWidth<769&&(t="agendaDay");var i=JSON.parse(d.attr("data-calendar-ids"));d.fullCalendar({header:{left:"prev,next title",right:"agendaDay,agendaWeek"},views:{month:{eventLimit:6}},ignoreTimezone:!0,titleFormat:"D MMMM YYYY",defaultView:t,columnFormat:"dd, D MMMM",slotLabelFormat:"H:mm",timeFormat:"H:mm",contentHeight:"auto",nowIndicator:!0,allDaySlot:!1,events:function(t,e,a,l){$.ajax({url:n,dataType:"json",data:{start:t.format("DD-MM-YYYY"),end:e.format("DD-MM-YYYY"),"calendar_id[]":i},success:function(t){t=Object.values(t);for(var e=[],a=24,n=0,i=0;i<t.length;i++){var o=null;t[i].color&&(o=t[i].color);var r=moment(t[i].start),s=moment(t[i].end);r.hour()<a&&(a=r.hour()),s.hour()>n&&(n=s.hour(),s.minute()&&(n+=1)),e.push({id:t[i].id,title:t[i].name,start:r,end:s,backgroundColor:o,borderColor:o})}a=a<10?"0"+a+":00":a+":00",n=n<10?"0"+n+":00":n+":00",d.fullCalendar("option","minTime",a),d.fullCalendar("option","maxTime",n),l(e)}})}})}},{key:"moduleMenu",value:function(t){var e=t.find(".navbar-nav > .nav-item.has-children");e.find("> ul > .nav-item:first-child").addClass("hover");function a(t){n=t.pageX<i?"left":"right",i=t.pageX}var n="right",i=0;e.on("mouseover",function(){t.addClass("hover"),document.addEventListener("mousemove",a)}),e.on("mouseout",function(){t.removeClass("hover"),document.removeEventListener("mousemove",a)});var o=null,r=null;e.each(function(t,e){var a=$(e).find("> ul > .nav-item");a.on("mousemove",function(t){o=$(t.currentTarget),clearTimeout(r),"right"!==n?(a.removeClass("hover"),o.addClass("hover")):r=setTimeout(function(){a.removeClass("hover"),o.addClass("hover")},300)})}),e.click(function(t){$(t.target).closest("li").toggleClass("expanded")})}},{key:"moduleFavorites",value:function(){function i(){var e=new Set;try{var t=Cookies.get("propertiesFavoritesIds");t&&(e=new Set(JSON.parse(t)))}catch(t){e=new Set}a.find(".favorites-overview").each(function(){$(this).find(".favorites-count").html("".concat(e.size))})}var a=$("body"),o=$("#favorites-shift");i();function r(){var e=new Set,t=Cookies.get("propertiesFavoritesIds");try{t&&(e=new Set(JSON.parse(t)))}catch(t){e=new Set}var a=o.find(".favorites-list");a.html(""),o.find(".favorites-count").html("".concat(e.size)),o.removeClass("d-none"),setTimeout(function(){o.addClass("expanded")},10),$.ajax({url:"/favorites",data:{id:Array.from(e).join(",")},success:function(t){a.html(t)}}),i()}function e(){o.removeClass("expanded"),setTimeout(function(){o.addClass("d-none")},300)}a.on("click",".add-to-favorites",function(t){var e=+$(t.currentTarget).attr("data-id")||null,a=new Set,n=Cookies.get("propertiesFavoritesIds");try{n&&(a=new Set(JSON.parse(n)))}catch(t){a=new Set}a.add(e),Cookies.set("propertiesFavoritesIds",JSON.stringify(Array.from(a)),{expires:365,path:"/"}),r()}),a.on("click",".favorites-overview",function(t){r()}),o.click(function(t){$(t.target).hasClass("favorites-overlay")&&e()}),o.find(".favorites-close").click(function(){e()}),o.on("click",".remove",function(){var t=$(this).closest(".favorites-item"),e=+t.attr("data-id"),a=new Set,n=Cookies.get("propertiesFavoritesIds");try{n&&(a=new Set(JSON.parse(n)))}catch(t){a=new Set}a.delete(e),Cookies.set("propertiesFavoritesIds",JSON.stringify(Array.from(a)),{expires:365,path:"/"}),t.remove(),o.find(".favorites-count").html("".concat(a.size)),i()})}}]),s}(),o=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"manage",value:function(t){e.filtersSubcategories(t)}},{key:"filtersSubcategories",value:function(t){t.on("click",".filters-left .subcategories ul .icon",function(){$(this).hasClass("closed")?($(this).parent().find(" > ul").stop().slideDown(200),$(this).removeClass("icon-plus2").addClass("icon-minus2")):($(this).parent().find(" > ul").stop().slideUp(200),$(this).addClass("icon-plus2").removeClass("icon-minus2")),$(this).toggleClass("closed")})}}]),e}(),r=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"show",value:function(t){t.find("form").validate({highlight:function(t){$(t).parent().removeClass("has-success").addClass("has-error")},unhighlight:function(t){$(t).parent().removeClass("has-error").addClass("has-success")},errorPlacement:function(t,e){$(e).parent().removeClass("has-success").addClass("has-error"),$(e).parent().find(".feedback-message").append(t)},ignore:".validation-ignore, .ql-editor"})}}]),t}(),s=function(){function s(){_classCallCheck(this,s)}return _createClass(s,null,[{key:"index",value:function(i){var t=this;!function(){var t=Cookies.get("cartDataJSON");if(void 0===t)return;var e=null;try{e=JSON.parse(t)}catch(t){e=[]}var a=!1;for(var n in e)void 0===e[n].bundle_id&&(a=!0),0===e[n].bundle_id&&(a=!0),void 0===e[n].selection_id&&(a=!0);a&&Cookies.remove("cartDataJSON",{path:"/"})}(),i.on("click",".bundle-option .product",function(t){t.preventDefault(),t.stopPropagation();var e=$(this).find("a").attr("href");window.open(e,"_blank").focus()}),i.on("click",".bundle-option-header",function(t){t.preventDefault(),t.stopPropagation();var e=$(this).attr("data-id"),a=i.find('.bundle-option[data-id="'.concat(e,'"]'));0!==a.length&&$("html, body").animate({scrollTop:a.offset().top},300)}),i.on("click",".bundle-option .product .shopping-cart",function(t){t.preventDefault(),t.stopPropagation();var e=$(this).closest(".product"),a=e.closest(".bundle-option");e.hasClass("selected")?(a.removeClass("selected"),a.find(".product").removeClass("selected")):(a.addClass("selected"),a.find(".product").removeClass("selected"),e.addClass("selected"),$("html, body").animate({scrollTop:a.offset().top},300));var n=0;i.find(".bundle-option .product.selected").each(function(){n+=parseFloat($(this).attr("data-price"))}),n=accounting.formatMoney(n,""),i.find(".bundle-overview").find("strong").html(n)}),i.on("click",".to-shopping-cart",function(t){t.preventDefault(),t.stopPropagation(),s.toShoppingCart($(this))}),i.on("click",".to-shopping-cart-many",function(t){t.preventDefault(),t.stopPropagation(),s.toShoppingCartMany($(this))}),i.on("click",".to-shopping-cart-bundle",function(t){t.preventDefault(),t.stopPropagation(),s.toShoppingCartBundle($(this))}),i.on("click",".to-shopping-cart-increase",function(){t.increaseToShoppingCartQuantity(i)}),i.on("click",".to-shopping-cart-decrease",function(){t.decreaseToShoppingCartQuantity(i)}),$("body").on("cart:refresh",function(){s.refreshShift()})}},{key:"toShoppingCart",value:function(t){var e=parseInt(t.attr("data-id")),a=parseFloat(t.attr("data-price")),n=parseFloat(t.attr("data-current-price-without-tax")),i=parseFloat(t.attr("data-original-price")),o=d.getItemCount(e);d.setItemCount(e,++o,a,n,i),s.expandShift(),$("body").trigger("cart:refresh")}},{key:"toShoppingCartMany",value:function(t){var e=+t.attr("data-id"),a=parseFloat(t.attr("data-price")),n=+t.closest(".price").find(".to-shopping-cart-quantity").html(),i=parseFloat(t.attr("data-current-price-without-tax")),o=parseFloat(t.attr("data-original-price")),r=d.getItemCount(e);d.setItemCount(e,r+n,a,i,o),s.expandShift(),$("body").trigger("cart:refresh")}},{key:"toShoppingCartBundle",value:function(){if($(".bundle-option.is-required:not(.selected)").length)return swal({title:"Proszę wybrać produkt z każdej grupy.",type:"error",showCancelButton:!1,showConfirmButton:!0}),null;var t=$("body .bundle-option .product.selected");if(t.length<1)return swal({title:"Proszę wybrać produkt.",type:"error",showCancelButton:!1,showConfirmButton:!0}),null;t.each(function(t,e){var a=+$(e).attr("data-bundle-id")||null,n=d.getItems();for(var i in n)n[i].bundle_id===a&&n.splice(i,1);Cookies.set("cartDataJSON",JSON.stringify(n),{expires:28,path:"/"})}),t.each(function(t,e){var a=$(e),n=+a.attr("data-id"),i=+a.attr("data-bundle-selection-id"),o=+a.attr("data-bundle-id"),r=parseFloat(a.attr("data-price")),s=(r/(1+parseFloat(a.attr("data-vat-value"))/100)).toFixed(2),l=parseFloat(a.attr("data-original-price"));d.setItemCount(n,1,r,s,l,o,i)}),s.expandShift(),$("body").trigger("cart:refresh")}},{key:"getToShoppingCartQuantity",value:function(t){return+t.find(".to-shopping-cart-quantity").html()}},{key:"increaseToShoppingCartQuantity",value:function(t){var e=this.getToShoppingCartQuantity(t);t.find(".to-shopping-cart-quantity").html(e+1)}},{key:"decreaseToShoppingCartQuantity",value:function(t){var e=this.getToShoppingCartQuantity(t)-1;e<1&&(e=1),t.find(".to-shopping-cart-quantity").html(e)}},{key:"expandShift",value:function(){var o=d.getItems(),t=[];for(var e in o)t.push(o[e].id);$.get({url:a.pathAPI("products"),data:{id:t},success:function(t){var r=$("#shopping-cart-shift");if(void 0!==t.data){var a=t.data;if(!(a.length<1)){var h=r.find(".list");h.find("> *").remove(),r.hasClass("has-close-listener")||(r.addClass("has-close-listener"),r.click(function(t){$(t.target).hasClass("overlay")&&(r.removeClass("expanded"),setTimeout(function(){r.addClass("d-none")},300))}),r.find(".trigger-close").click(function(){r.removeClass("expanded"),setTimeout(function(){r.addClass("d-none")},300)}));var n=[],e=function(e){var t=a.find(function(t){return t.id===o[e].id});(t=JSON.parse(JSON.stringify(t))).count=o[e].count,t.selection_id=o[e].selection_id,t.bundle_id=o[e].bundle_id,t.bundle_id&&(t.current_price=o[e].price,t.current_price_without_tax=o[e].price_without_tax),n.push(t)};for(var i in o)e(i);n.forEach(function(t){var e=t.count,a=$("<div>",{class:"product","data-id":t.id,"data-bundle-id":t.bundle_id,"data-bundle-selection-id":t.selection_id,"data-price":t.current_price,"data-current-price-without-tax":t.current_price_without_tax,"data-original-price":t.price});a.append($("<span>",{class:"icon icon-cross product-remove"}));var n=$("<div>",{class:"row top"}),i=$("<div>",{class:"col-4 image"});0<t.gallery.length&&i.append($("<img>",{src:t.gallery[0].small}));var o=$("<div>",{class:"col-8 information"});o.append($("<a>",{class:"h4",href:t.url,text:t.name}));var r=$("<div>",{class:"manage"}),s=$("<div>",{class:"trigger-increase"}).append($("<span>",{class:"icon icon-plus2"})),l=$("<div>",{class:"input-holder"}).append($("<input>",{type:"number",value:e,class:"form-control"})),d=$("<div>",{class:"trigger-decrease"}).append($("<span>",{class:"icon icon-minus2"})),c=t.price>t.current_price,u=$("<div>",{class:"prices".concat(c?" with-sale":"")}),f=$("<del>",{class:"original-price",text:accounting.formatMoney(t.price,"zł")}),p=$("<span>",{class:"current-price",text:accounting.formatMoney(t.current_price,"zł")}),m=$("<span>",{class:"current-price-without-tax",text:accounting.formatMoney(t.current_price_without_tax,"zł")});u.append(f),u.append(p),u.append(m),t.bundle_id||(r.append(s),r.append(d),r.append(l)),r.append(u),n.append(i),n.append(o),a.append(n),a.append(r),h.append(a)}),r.removeClass("d-none"),setTimeout(function(){r.addClass("expanded")},10),r.find(".product").each(function(){var t=$(this),e=t.find("input"),a=parseInt(t.attr("data-id")),n=parseFloat(t.attr("data-price")),i=parseFloat(t.attr("data-current-price-without-tax")),o=parseFloat(t.attr("data-original-price"));t.find(".trigger-increase").click(function(){var t=+e.val()||0;t++,e.val(t),d.setItemCount(a,t,n,i,o),$("body").trigger("cart:refresh")}),t.find(".trigger-decrease").click(function(){var t=+e.val()||1;--t<1&&(t=1),e.val(t),d.setItemCount(a,t,n,i,o),$("body").trigger("cart:refresh")}),t.find(".product-remove").click(function(t){var e=$(t.currentTarget).closest(".product"),a=+e.attr("data-id"),n=+e.attr("data-bundle-id");n?(d.removeItem(a,n),r.find('.product[data-bundle-id="'+n+'"]').remove()):(d.removeItem(a),e.remove()),$("body").trigger("cart:refresh")}),e.change(function(){var t=parseInt(e.val())||1;e.val(t),d.setItemCount(a,t,n,i,o),$("body").trigger("cart:refresh")})})}}}})}},{key:"refreshShift",value:function(){var t=$("#shopping-cart-shift"),e=d.getItems(),a=0,n=0,i=0;new Set(e).forEach(function(t){a+=t.count,n+=t.count*t.price,i+=t.count*t.price_without_tax}),t.find(".total-count").html(a),t.find(".total-price .with-tax .value").html(accounting.formatMoney(n,"zł")),t.find(".total-price .without-tax .value").html(accounting.formatMoney(i,"zł")),d.updateFreeAboveButton(n)}}]),s}(),l=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"index",value:function(a){a.on("click",".package-item",function(t){var e=$(t.currentTarget).attr("data-pdf");e.length&&window.open("".concat(e),"_blank").focus()}),a.find(".offer-menu button").click(function(t){var e=$(t.currentTarget).attr("data-content");a.find('button[data-content="'.concat(e,'"]')).addClass("active"),a.find('button[data-content!="'.concat(e,'"]')).removeClass("active"),a.find('.offer-content > .item[data-content="'.concat(e,'"]')).show(),a.find('.offer-content > .item[data-content!="'.concat(e,'"]')).hide()}),a.find(".listable-files .listable-content .item").click(function(t){t.stopPropagation(),t.preventDefault();var e=$(t.currentTarget).find("a").attr("href");window.open("".concat(e),"_blank").focus()}),a.find(".investment").each(function(t,e){var n=$(e);n.on("click",".primary, .secondary",function(t){t.preventDefault();var e=n.attr("data-images"),a=$(t.currentTarget||t.target).attr("data-index");p.show(e,a)})})}}]),t}(),t=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"initApplication",value:function(){var t=$("#content");e.initRoutes(t),AOS.init({once:!0})}},{key:"initRoutes",value:function(t){switch($("body").attr("data-route")){case"cart.create":(new d).index(t);break;case"consents.requests.show":r.show(t);break;case"offers.show":l.index(t)}s.index(t)}}]),e}();$.validator.addMethod("password_custom",function(t,e){return this.optional(e)||n.validatePassword(e,!1)},"Please enter valid password");var c=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"prepare",value:function(){$("select").select2({width:"100%",minimumResultsForSearch:10}),$(function(){$("body").tooltip({selector:'[data-toggle="tooltip"]',delay:400})}),$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}})}},{key:"manage",value:function(){var t=$("body");i.manage(t),o.manage(t)}}]),t}();$(document).ready(function(){c.prepare(),c.manage(),t.initApplication()})});