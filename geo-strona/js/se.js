$(function(){function f(k,j){return((k==j)?0:((k>j)?1:-1))}function g(j){return j.split(/,\s*/)}function a(){var l=$('#se [name="lok"]');var k=l.val();var j=$('#se [name="lok_last"]').val();if(!k||(k&&k.length<3)||(k&&j!=k)){d={};$("#se_loc_80, #se_loc_60, #se_loc_50, #se_loc_40").val("");$(".se_loc_90, .se_loc_100, .se_loc_120").remove();return false}if(k&&($("#se_loc_80").val()||$("#se_loc_60").val()||$("#se_loc_50").val()||$("#se_loc_40").val()||$(".se_loc_90").val()||$(".se_loc_100").val()||$(".se_loc_120").val())){return true}return false}function b(){if(typeof locData!=="undefined"){for(var k in locData){var l=k.split("_")[1];d[l]=locData[k]}}}$("#se_lokalizacja").tooltip({title:"Nie wybrano lokalizacji",placement:"top",trigger:"manual"});$("#se_lokalizacja").on("focus",function(){$("#se_lokalizacja").tooltip("hide")});$("#se").submit(function(k){if($("#se_type").val()!=2){k.preventDefault();if(a()){$(this).unbind("submit");var j=this;setTimeout(function(){$(j).submit()},300)}else{document.getElementById("se_lokalizacja").title="Wybierz lokalizacje z listy";$("#se_lokalizacja").attr("data-original-title","Wybierz lokalizacje z listy");$("#se_lokalizacja").tooltip("show")}}else{if($("#se_lokalizacja").val().length>0){k.preventDefault();if(a()){$(this).unbind("submit");var j=this;setTimeout(function(){$(j).submit()},300)}else{document.getElementById("se_lokalizacja").title="Wybierz lokalizacje z listy";$("#se_lokalizacja").attr("data-original-title","Wybierz lokalizacje z listy");$("#se_lokalizacja").tooltip("show")}}}});var c=$("#se .select2").select2({allowClear:false,minimumResultsForSearch:Infinity});if(navigator.userAgent.toLowerCase().indexOf("firefox")===-1){$("#se .select2").data("open-fix",false);c.on("select2:close",function(j){if($(this).data("open-fix")){$(this).select2("open");$(this).data("open-fix",false)}else{$(this).data("open-fix",false)}}).on("select2:selecting",function(j){if($(this).data("open-fix")){j.preventDefault();$(this).data("open-fix",false)}})}else{$("#se .select2").data("open-fix",false);$('#se .select2[data-allow-clear="true"]').data("open-fix",true);c.on("select2:selecting",function(j){if($(this).data("open-fix")){j.preventDefault();$(this).data("open-fix",false)}})}var e=$("#se .select2-multiple").append('<option class="select2-checkall" disabled>zaznacz wszystko</option>').select2({allowClear:false,closeOnSelect:false,templateResult:function(p){var l=$("<span></span>");var n=$('<input type="checkbox" class="select2-checkbox" />');var j=$('<label class="select2-checkbox-label"></label>');if(p.element){if($(p.element).hasClass("select2-checkall")){var o=$(p.element).parent();if(o.data("s2ca")===undefined){o.data("s2ca",false)}var m=true;o.find("option").each(function(){if(!$(this).hasClass("select2-checkall")){var q=o.attr("id");if(!(q=="se_media"&&$(this).text()=="brak")){if(!$(this).is(":selected")){m=false;return false}}}});o.data("s2ca",m);var k="zaznacz wszystko";if(o.data("s2ca")==true){k="odznacz wszystko"}l.addClass("select2-checkall").data({s2ca:o.data("s2ca"),s2ca_rel:o.attr("id")}).text(k)}else{n.prop("checked",p.element.selected);j.text(p.text).data("s2cc",p.element.selected);l.append(n);l.append(j)}}else{l.text(p.text)}return l}});e.on("select2:opening",function(){var k=$(".select2-container--open .select2-results__options");var j=0;k.find(".select2-results__option").each(function(){j+=$(this).outerHeight(true)});if(j>200){j=200}k.slimScroll({color:"#aaa",distance:"3px",height:j})});c.on("select2:open",function(){var j=$(".select2-container--open .select2-results__options");j.slimScroll({color:"#aaa",distance:"3px",height:"auto"})});$(document).on("click",".select2-checkall",function(){var l=true;if($(this).data("s2ca")==true){l=false}var j=$("#"+$(this).data("s2ca_rel"));var k=$(this).data("s2ca_rel");j.find("option").each(function(){if($(this).prop("disabled")==false){if(k=="se_media"&&$(this).text()=="brak"){$(this).prop("selected",false)}else{$(this).prop("selected",l)}}});j.trigger("change");$(this).closest(".select2-results__options").find(".select2-results__option").each(function(){if(k=="se_media"&&$(this).find(".select2-checkbox-label").text()=="brak"){$(this).attr("aria-selected",false).find(".select2-checkbox-label").data("s2cc",false)}else{$(this).attr("aria-selected",l).find(".select2-checkbox-label").data("s2cc",l)}});$(this).data("s2ca",l);j.data("s2ca",l);if(l==true){$(this).text("odznacz wszystko")}else{$(this).text("zaznacz wszystko")}});$(document).on("click",".select2-checkbox-label",function(){var l=$(this).closest(".select2-results__options").find(".select2-checkall");var j=$("#"+l.data("s2ca_rel"));if($(this).data("s2cc")==true){$(this).data("s2cc",false);l.data("s2ca",false).text("zaznacz wszystko");j.data("s2ca",false)}else{$(this).data("s2cc",true);var k=0;var m=0;$(this).closest(".select2-results__options").find(".select2-results__option").each(function(){if($(this).attr("aria-disabled")!=="true"){k++;if($(this).attr("aria-selected")==="true"){m++}}});if(k==m){l.data("s2ca",true).text("odznacz wszystko");j.data("s2ca",true)}}});$(window).on("resize",function(){$.onResizeSE()});$.onResizeSE();$(window).on("load",function(){$(".advs-show").show()});$("#se_obi").on("change",function(){$.onChangeTypeOfProperty()});var i=false;$(document).keydown(function(k){var j=k.charCode||k.keyCode||0;if(j==17){i=true}}).keyup(function(k){var j=k.charCode||k.keyCode||0;if(j==17){i=false}});$("[data-minv]").keydown(function(k){var j=k.charCode||k.keyCode||0;if(j==17){i=true;return true}return(j==8||j==9||j==13||j==46||j==108||j==109||j==110||j==189||j==190||j==188||(j==86&&i)||(j==67&&i)||(j>=35&&j<=40)||(j>=48&&j<=57)||(j>=96&&j<=105))});$("[data-minv]").on("blur",function(){if(isNaN($(this).val())){$(this).val("")}});$("[data-minv]").on("change",function(){var j=parseFloat($(this).attr("data-minv"));var k=$(this).val().replace(",",".");if(k<j){$(this).val(j)}else{$(this).val(k)}});$("#se_to").on("change",function(){if($(this).val()=="gotowe"){$("#se_tk").val("").trigger("change").parent().hide()}else{$("#se_tk").parent().show()}});$("#se_to").trigger("change");$.onChangeTypeOfProperty();$(".clear-criteria").on("click",function(){$('#se input:not([type="checkbox"])').not("#se_type").val("");$('#se input[type="checkbox"]').prop("checked",false);$("#se .select2, #se .select2-multiple").val("").trigger("change");$("#se .select2-multiple").data("s2ca",false);$(".se_loc_90, .se_loc_100, .se_loc_120").remove();d={};$("#se_obi").val($("#se_obi option:first").val()).trigger("change");$("[name='akc']").val($("[name='akc'] option:eq(1)").val()).trigger("change");$("[name='ryn']").val($("[name='ryn'] option:first").val()).trigger("change")});$(".advanced-search-expand").on("click",function(){$(".advanced-search").slideToggle(400,function(){$(".advanced-search-expand > i").toggleClass("fa-caret-down").toggleClass("fa-caret-up")})});var h={};var d={};b();$('#se [name="lok"]').data("prval",$(this).val()).bind("keydown",function(j){if(j.keyCode===$.ui.keyCode.TAB&&$(this).autocomplete("instance").menu.active){j.preventDefault()}}).bind("propertychange change click keyup input paste",function(j){if(j.type=="keyup"){if($.inArray(j.keyCode,[9,10,13,16,17,18,19,20,27,33,34,35,36,37,38,39,40,45,91,92,93,224])!==-1){return}}a()}).autocomplete({source:function(n,j){var m=n.term;if(m in h){j(h[m]);return}var k=window.location.origin;if(k=="http://lovekrakow.koryto.krn.pl"){var l="true"}else{var l="false"}$.ajax({url:"https://www.krn.pl/searchlocation",method:"post",dataType:"json",data:{q:n.term,l:l,locdata:function(){return JSON.stringify(d)}},success:function(o){j(o)}})},minLength:1,delay:500,autoFocus:true,select:function(j,k){var m=[];var l=[];if(k.item.id_province1){$("#se_loc_40").val(k.item.id_province1);d[40]={id:k.item.id_province1,name:k.item.name_province1};l.push(k.item.name_province1)}if(k.item.id_province2){$("#se_loc_50").val(k.item.id_province2);d[50]={id:k.item.id_province2,name:k.item.name_province2};l.push(k.item.name_province2)}if(k.item.id_province3){$("#se_loc_60").val(k.item.id_province3);d[60]={id:k.item.id_province3,name:k.item.name_province3};l.push(k.item.name_province3)}if(k.item.id_city){$("#se_loc_80").val(k.item.id_city);d[80]={id:k.item.id_city,name:k.item.name_city};m.push(k.item.name_city)}if(k.item.id_district1){$("#loc-pam-wrap").append('<input type="hidden" name="ad90[]" class="se_loc_90" value="'+k.item.id_district1+'" />');if(typeof d[90]==="undefined"){d[90]=[]}d[90].push({id:k.item.id_district1,name:k.item.name_district1});m.push(k.item.name_district1)}if(k.item.id_district2){$("#loc-pam-wrap").append('<input type="hidden" name="ad100[]" class="se_loc_100" value="'+k.item.id_district2+'" />');if(typeof d[100]==="undefined"){d[100]=[]}d[100].push({id:k.item.id_district2,name:k.item.name_district2});m.push(k.item.name_district2)}if(k.item.id_street){$("#loc-pam-wrap").append('<input type="hidden" name="ad120[]" class="se_loc_120" value="'+k.item.id_street+'" />');if(typeof d[120]==="undefined"){d[120]=[]}d[120].push({id:k.item.id_street,name:k.item.name_street});m.push(k.item.name_street)}if(m.length>0){this.value=m.join(", ").replace(",,",",").replace(",,,",",")}else{this.value=l.join(", ").replace(",,",",").replace(",,,",",")}$('#se [name="lok_last"]').val(this.value);return false},search:function(j,k){$(this).parent().addClass("se-active")},response:function(j,k){$(this).parent().removeClass("se-active")}}).autocomplete("instance")._renderItem=function(j,k){if(k.name=="Ostatnio ogladane"||k.name=="Wybierz z listy"||k.name=="Błędna lokalizacja. Prosimy sprawdzić poprawność danych lub wpisać więcej znaków."){return $("<li class='ui-state-disabled'>").append((k.name?k.name+(k.name_province1?" <small>("+k.name_province1+")</small>":""):(k.name_ext?"<small>"+k.name_ext+"</small>":""))).appendTo(j)}else{return $("<li>").append((k.name?k.name+(k.name_province1?" <small>("+k.name_province1+")</small>":""):(k.name_ext?"<small>"+k.name_ext+"</small>":""))).appendTo(j)}}});$.onResizeSE=function(){var d=window,b="inner";if(!("innerWidth" in window)){b="client";d=document.documentElement||document.body}if(d[b+"Width"]<768){var c=$("#se .search-second-line .se-xs-advanced");if(c.length>0){c.prependTo($("#se .advanced-search > .row").first()).find(".input-green").addClass("input-gray")}}else{var c=$("#se .advanced-search > .row").first().find(".se-xs-advanced");if(c.length>0){c.prependTo("#se .search-second-line").find(".input-gray").removeClass("input-gray")}}};$.onChangeTypeOfProperty=function(){$("#se [data-for]").hide();var j=$('#se [name="obi"]');var l=$('#se [name="akc"]');$("#se [data-for]").each(function(){if(jQuery.inArray(j.select2("val"),String($(this).data("for")).split(","))!==-1){$(this).show()}});var m=j.val();var g="";var f=0;var d=l.val();if(typeof seActionTypes!=="undefined"){if(seActionTypes[m]!==undefined){g+='<option value="">typ transakcji</option>';for(var h in seActionTypes[m]){g+='<option value="'+seActionTypes[m][h].id+'"';if(seActionTypes[m][h].disabled!==undefined&&seActionTypes[m][h].disabled==true){g+=" disabled"}else{if(seActionTypes[m][h].id==d){f=d}}g+=">"+seActionTypes[m][h].name+"</option>"}}}l.html(g).val(f).trigger("change");if(m=="0"||m=="1"||m=="3"){var e="";var a=$("#se_pow_dod").val();if(typeof seExtraSpaceTypes!=="undefined"){if(seExtraSpaceTypes[m]!==undefined){for(var h in seExtraSpaceTypes[m]){e+='<option value="'+seExtraSpaceTypes[m][h].id+'"';if($.inArray(seExtraSpaceTypes[m][h].id.toString(),a)!==-1){e+=" selected"}e+=">"+seExtraSpaceTypes[m][h].name+"</option>"}e+='<option class="select2-checkall" disabled>zaznacz wszystko</option>'}}$("#se_pow_dod").html(e).data("s2ca",false).trigger("change");var o="";var c=$("#se_stw").val();if(typeof seFinishStateTypes!=="undefined"){if(seFinishStateTypes[m]!==undefined){for(var h in seFinishStateTypes[m]){o+='<option value="'+seFinishStateTypes[m][h].id+'"';if($.inArray(seFinishStateTypes[m][h].id.toString(),c)!==-1){o+=" selected"}o+=">"+seFinishStateTypes[m][h].name+"</option>"}o+='<option class="select2-checkall" disabled>zaznacz wszystko</option>'}}$("#se_stw").html(o).data("s2ca",false).trigger("change")}var p="";var k=$("#se_media").val();if(typeof seMediaTypes!=="undefined"){if(seMediaTypes[m]!==undefined){for(var h in seMediaTypes[m]){p+='<option value="'+seMediaTypes[m][h].id+'"';if($.inArray(seMediaTypes[m][h].id.toString(),k)!==-1){p+=" selected"}p+=">"+seMediaTypes[m][h].name+"</option>"}p+='<option class="select2-checkall" disabled>zaznacz wszystko</option>'}}$("#se_media").html(p).data("s2ca",false).trigger("change");if(m=="5"){$("#se-pdl-0 #se-pdl").removeClass("input-gray").appendTo($("#se-pdl-5"));$("#se-pdh-0 #se-pdh").removeClass("input-gray").appendTo($("#se-pdh-5"))}else{$("#se-pdl-5 #se-pdl").addClass("input-gray").appendTo($("#se-pdl-0"));$("#se-pdh-5 #se-pdh").addClass("input-gray").appendTo($("#se-pdh-0"))}if(m=="7"){$("#se-lpkl-0 #se_lpkl").addClass("input-gray").appendTo($("#se-lpkl-7"));$("#se-lpkl-0 #se_lpkh").addClass("input-gray").appendTo($("#se-lpkh-7"))}else{$("#se-lpkl-7 #se_lpkl").removeClass("input-gray").appendTo($("#se-lpkl-0"));$("#se-lpkl-7 #se_lpkh").removeClass("input-gray").appendTo($("#se-lpkh-0"))}if(m=="3"||m=="8"||m=="0"){var q="";var b=$("#se_krA").val();if(typeof seCommercialTypes!=="undefined"){if(seCommercialTypes[m]!==undefined){for(var h in seCommercialTypes[m]){q+='<option value="'+seCommercialTypes[m][h].id+'"';if($.inArray(seCommercialTypes[m][h].id.toString(),b)!==-1){q+=" selected"}q+=">"+seCommercialTypes[m][h].name+"</option>"}q+='<option class="select2-checkall" disabled>zaznacz wszystko</option>'}}$("#se_krA").html(q).data("s2ca",false).trigger("change")}if(m=="101"){var r="";var n=$("#area").val();if(typeof seAreaTypes!=="undefined"){if(seAreaTypes!==undefined){for(var h in seAreaTypes){r+='<option value="'+seAreaTypes[h].id+'"';if($.inArray(seAreaTypes[h].id.toString(),n)!==-1){r+=" selected"}r+=">"+seAreaTypes[h].name+"</option>"}r+='<option class="select2-checkall" disabled>zaznacz wszystko</option>'}}$("#area").html(r).data("s2ca",false).trigger("change")}};